<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Canonical Forms</title>
  <meta name="description" content="        Canonical Forms    Canonical Forms Although a state-space model may uniquely represent a given dynamicsystem, there is no state-space model that uniq...">

  <link rel="canonical" href="https://cpjobling.github.io/eglm03-textbook/07/4/canon.html">
  <link rel="alternate" type="application/rss+xml" title="EGLM03 Modern Control Systems" href="https://cpjobling.github.io/eglm03-textbook/feed.xml">

  <meta property="og:url"         content="https://cpjobling.github.io/eglm03-textbook/07/4/canon.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Canonical Forms" />
<meta property="og:description" content="        Canonical Forms    Canonical Forms Although a state-space model may uniquely represent a given dynamicsystem, there is no state-space model that uniq..." />
<meta property="og:image"       content="https://cpjobling.github.io/eglm03-textbook/images/logo/logo.png" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://cpjobling.github.io/eglm03-textbook/07/4/canon.html",
  "headline": "Canonical Forms",
  "datePublished": "2020-03-19T10:47:14+00:00",
  "dateModified": "2020-03-19T10:47:14+00:00",
  "description": "        Canonical Forms    Canonical Forms Although a state-space model may uniquely represent a given dynamicsystem, there is no state-space model that uniq...",
  "author": {
    "@type": "Person",
    "name": "Dr Chris P. Jobling"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://cpjobling.github.io/eglm03-textbook",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://cpjobling.github.io/eglm03-textbook",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/eglm03-textbook/assets/css/styles.css">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/eglm03-textbook/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    },
    
    // Number LaTeX-style equations
    "TeX": {
        equationNumbers: {
          autoNumber: "all"
        }
    }
    
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML' async></script>


  <!-- DOM updating function -->
  <script src="/eglm03-textbook/assets/js/page/dom-update.js"></script>

  <!-- Selectors for elements on the page -->
  <script src="/eglm03-textbook/assets/js/page/documentSelectors.js"></script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/eglm03-textbook';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script src="/eglm03-textbook/assets/js/page/anchors.js" async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->



  <!-- Load the auto-generating TOC (non-async otherwise the TOC won't load w/ turbolinks) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.8.1/tocbot.min.js" async></script>
  <script src="/eglm03-textbook/assets/js/page/tocbot.js"></script>

  <!-- Google analytics -->
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '');
</script>



  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/eglm03-textbook/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/eglm03-textbook/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/eglm03-textbook/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  

  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js" async></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>

  <!-- Load JS that depends on site variables -->
  <script src="/eglm03-textbook/assets/js/page/copy-button.js" async></script>

  <!-- Hide cell code -->
  <script src="/eglm03-textbook/assets/js/page/hide-cell.js" async></script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/eglm03-textbook/assets/css/styles.css",
        style: "#textbook_content {padding-top: 40px};",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList,
        documentTitle: "EGLM03 Modern Control Systems"
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- Include the ThebeLab config so it gets reloaded on each page -->
    <script type="text/x-thebe-config">{
    requestKernel: true,
    binderOptions: {
    repo: "YOUR-ORG/YOUR-REPO",
    ref: "gh-pages",
    },
    codeMirrorConfig: {
    theme: "abcdef",
    mode: ""
    },
    kernelOptions: {
    kernelName: "matlab",
    path: "content/07/4"
    }
}
</script>

    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://jupyterbook.org/"><img src="/eglm03-textbook/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" alt="textbook logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">EGLM03 Modern Control Systems</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="">
        <a class="c-sidebar__entry"
          href=".html"
        >
          
          
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/intro.html"
        >
          
          Introduction to this Module
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/background/index">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/background/index.html"
        >
          
          Background
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/background/rlocus/what_is_rlocus">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/background/rlocus/what_is_rlocus.html"
              >
                
                What is the root locus?
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/background/rlocus/what_does_the_rlocus_represent">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/background/rlocus/what_does_the_rlocus_represent.html"
              >
                
                What does the root locus represent?
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/background/rlocus/sketching_rules">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/background/rlocus/sketching_rules.html"
              >
                
                What are the rules for sketching a root locus?
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/01/modsim">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/01/modsim.html"
        >
          
            1.
          
          Systems Modelling and Simulation
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/02/ssntr">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/02/ssntr.html"
        >
          
            2.
          
          Steady-State and Transient Response
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/03/classical">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/03/classical.html"
        >
          
            3.
          
          Classical Control Systems Design
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/03/1/intro">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/03/1/intro.html"
              >
                
                  3.1
                
                Introducing phase-lead compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/03/2/velfb">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/03/2/velfb.html"
              >
                
                  3.2
                
                Introduction to Root Locus Design
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/03/3/pplusd">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/03/3/pplusd.html"
              >
                
                  3.3
                
                Proportional plus derivative compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/03/4/leadc">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/03/4/leadc.html"
              >
                
                  3.4
                
                Lead compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/03/5/analrloc">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/03/5/analrloc.html"
              >
                
                  3.5
                
                Analytical Root-Locus Design of Phase-Lead Compensators
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/03/6/lagc">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/03/6/lagc.html"
              >
                
                  3.6
                
                Lag compensation
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/04/pid">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/04/pid.html"
        >
          
            4.
          
          PID Compensation
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/04/0/intro">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/04/0/intro.html"
              >
                
                  4.1
                
                Introduction to PID Compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/04/1/zeigler">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/04/1/zeigler.html"
              >
                
                  4.2
                
                Zeigler-Nichols Tuning Algorithms
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/04/2/tuning">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/04/2/tuning.html"
              >
                
                  4.3
                
                Manually Tuning a PID compensator
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/04/3/analpid">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/04/3/analpid.html"
              >
                
                  4.4
                
                Analytical Design of a PID Compensator
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/04/4/autotune">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/04/4/autotune.html"
              >
                
                  4.5
                
                PID Autotuning in MATLAB
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/05/freqresp">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/05/freqresp.html"
        >
          
            5.
          
          Frequency Response Design
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/05/1/freqlead">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/05/1/freqlead.html"
              >
                
                  5.1
                
                Frequency Response Design of a Lead Compensator
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/05/2/freqlag">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/05/2/freqlag.html"
              >
                
                  5.2
                
                Frequency Response Design of a Lag Compensator
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/06/digital">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/06/digital.html"
        >
          
            6.
          
          Digital Control Systems
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/06/1/digi_intro">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/06/1/digi_intro.html"
              >
                
                  6.1
                
                Introduction to Digital Systems
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/06/2/dsm">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/06/2/dsm.html"
              >
                
                  6.2
                
                Digital System Models and System Response
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/06/3/cse">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/06/3/cse.html"
              >
                
                  6.3
                
                Continuous Systems Equivalence
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/06/4/digictrl">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/06/4/digictrl.html"
              >
                
                  6.4
                
                Introduction to Digital Control
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/07/index">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/07/index.html"
        >
          
            7.
          
          Modelling Systems in State-Space
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/07/1/intro2ss">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/07/1/intro2ss.html"
              >
                
                  7.1
                
                State-Space Models
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/07/2/tf4ss">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/07/2/tf4ss.html"
              >
                
                  7.2
                
                Laplace Transforms of State Space Models
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/07/3/tr4ss">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/07/3/tr4ss.html"
              >
                
                  7.3
                
                Time Response for State Space Models
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/07/4/canon">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/07/4/canon.html"
              >
                
                  7.4
                
                Canonical Forms
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/07/5/systransf">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/07/5/systransf.html"
              >
                
                  7.5
                
                Transformation of States and System Diagonalization
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/07/6/gensolution">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/07/6/gensolution.html"
              >
                
                  7.6
                
                The General Solution of LTI Systems
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/08/index">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/08/index.html"
        >
          
            8.
          
          State-Feedback Control
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/08/1/obsv_ctrl">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/08/1/obsv_ctrl.html"
              >
                
                  8.1
                
                Controllability and Observability
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/08/2/sfcontrol">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/08/2/sfcontrol.html"
              >
                
                  8.2
                
                State-Feedback Control
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/08/3/observers">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/08/3/observers.html"
              >
                
                  8.3
                
                State Observers
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/08/4/observer_controller">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/08/4/observer_controller.html"
              >
                
                  8.4
                
                Combined Observer and Controller
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/01/mattf">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/01/mattf.html"
        >
          
          Appendix A Defining Transfer Functions in MATLAB
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Homework</li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/homework/index">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/homework/index.html"
        >
          
          Homework Problems
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/revision/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/revision/problems.html"
              >
                
                Homework 1 - Revision
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/lead_compensation/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/lead_compensation/problems.html"
              >
                
                Homework 2 - Dominant Poles and Lead Compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/lag_compensation/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/lag_compensation/problems.html"
              >
                
                Homework 3 - Lag Compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/lag_lead_pid/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/lag_lead_pid/problems.html"
              >
                
                Homework 4 - Lag-Lead and PID Compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/freqresp/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/freqresp/problems.html"
              >
                
                Homework 5 - Frequency Response Cascade Compensator Design
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/digirev/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/digirev/problems.html"
              >
                
                Homework 6 - Digital Systems Revision
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/ss2tf/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/ss2tf/problems.html"
              >
                
                Homework 7 - Modelling Systems in Statespace
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/ssm/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/ssm/problems.html"
              >
                
                Homework 8 - State Space Modelling
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/ppo/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/ppo/problems.html"
              >
                
                Homework 9 - Pole Placement and Observers
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Handouts</li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/handouts/csd/index">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/handouts/csd/index.html"
        >
          
          Control System Design Methods
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/1">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/1.html"
              >
                
                1. Aims of Control Systems Analysis and Design
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/2">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/2.html"
              >
                
                2. Design Methods
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/3">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/3.html"
              >
                
                3. Design Strategies
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/4">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/4.html"
              >
                
                4. Design Criteria
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/5">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/5.html"
              >
                
                5. Some Useful Design Curves
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/ack">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/ack.html"
              >
                
                Acknowledgements
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/appendix">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/appendix.html"
              >
                
                Appendix -- Transfer Function Plots for Typical Transfer Functions
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Setting up your own version of this book</li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="setup/index">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/setup/index.html"
        >
          
          Control System Design Methods
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/setup/jupyter">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/setup/jupyter.html"
              >
                
                About Jupyter notebooks
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/setup/python">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/setup/python.html"
              >
                
                Installing Python
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/setup/setup">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/setup/setup.html"
              >
                
                Setting up your MATLAB-Jupyter Computing Environment
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/setup/jupyter-book">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/setup/jupyter-book.html"
              >
                
                Setting up jupyter-book
              </a>
            </li>
            
            
          
        </ul>
      

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://jupyterbook.org">Jupyter Book</a></p>
</nav>

      
      <div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <div class="c-topbar__buttons">
    <button
      id="js-sidebar-toggle"
      class="hamburger hamburger--arrowalt is-active"
    >
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="buttons">



  
  
  
  


</div>

  </div>
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="sidebar__right">
    <header><h4 class="nav__title"><img src="/eglm03-textbook/assets/images/list-solid.svg" alt="Search" />   On this page</h4></header>
    <nav class="onthispage">
    </nav>
  </aside>
  <a href="/eglm03-textbook/search.html" class="topbar-right-button" id="search-button">
    <img src="/eglm03-textbook/assets/images/search-solid.svg" alt="Search" />
  </a>
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
                  <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Canonical Forms</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Canonical-Forms">Canonical Forms<a class="anchor-link" href="#Canonical-Forms"> </a></h1><p>Although a state-space model may uniquely represent a given dynamic
system, there is no state-space model that uniquely represents a given
transfer function. That is there are many state-space models that can be
transformed into a given transfer function. If one begins the analysis
of a dynamic system from an analysis of the elementary dynamics then the
state space model that results from such an analysis will accurately
reflect the physical state variables in the system. However, if one's
analysis begins from a differential equation or (equivalently) from a
transfer function, then it is convenient to transform the model
description into one of a small number of "standard" or <em>canonical
forms</em>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-1:-Introducing-Canonical-Forms">Part 1: Introducing Canonical Forms<a class="anchor-link" href="#Part-1:-Introducing-Canonical-Forms"> </a></h2><p>Standard forms for state space models derived from differential
equations or transfer function models.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Derivation of the companion form</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Example</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Converting-a-Differential-Equation-into-State-Space-Form">Converting a Differential Equation into State Space Form<a class="anchor-link" href="#Converting-a-Differential-Equation-into-State-Space-Form"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These notes describe how a general differential equation may be converted into a state-space model.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Differential-Equation-into-State-Space">Differential Equation into State Space<a class="anchor-link" href="#Differential-Equation-into-State-Space"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Consider the general differential equation:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\begin{equation}\frac{d^{n}y}{dt^{n}} +
a_{n-1}\frac{d^{n-1}y}{dt^{n-1}}+a_{n-2}\frac{d^{n-2}y}{dt^{n-2}}+\cdots+a_1\frac{dy}{dt}+a_0
y = b_0 u\end{equation}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In class we will show how this can be converted into the so-called "companion form" state-space model.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We rearrange this equation so that the highest power is on the left</p>
$$\begin{equation}
\frac{d^{n}y}{dt^{n}} = -a_{n-1}\frac{d^{n-1}y}{dt^{n-1}}-a_{n-2}\frac{d^{n-2}y}{dt^{n-2}}-\cdots-a_1\frac{dy}{dt}-a_0 y + b_0 u.\end{equation}$$<p></p>
<p>Let:</p>
$$\begin{eqnarray*}
x_1 &amp;=&amp; y \\ x_2 &amp;=&amp; \frac{dy}{dt} \\
x_3 &amp; = &amp; \frac{d^2y}{dt^2} \\ 
\vdots \\ 
x_{n-1} &amp;=&amp; \frac{d^{n-2}y}{dt^{n-2}} \\ 
x_{n} &amp;=&amp; \frac{d^{n-1}y}{dt^{n-1}}
\end{eqnarray*}$$<p>If we differentiate both sides of these new definitions we obtain</p>
$$\begin{eqnarray*}
\dot{x}_1 &amp;=&amp; \frac{dy}{dt} \\
\dot{x}_2 &amp;=&amp; \frac{d^2y}{dt^2} \\
\dot{x}_3 &amp; = &amp; \frac{d^3y}{dt^3} \\ 
\vdots \\ 
\dot{x}_{n-1}  &amp;=&amp; \frac{d^{n-1}y}{dt^{n-1}} \\
\dot{x}_{n} &amp;=&amp; \frac{d^{n}y}{dt^{n}}
\end{eqnarray*}$$<p>These equations represent the left-hand-side of the state equations and if we make the substitutions we get</p>
$$\begin{eqnarray*}
\dot{x}_1 &amp;=&amp; x_2 \\ 
\dot{x}_2 &amp;=&amp;  x_3   \\
\dot{x}_3 &amp; = &amp;  x_4 \\ 
\vdots \\ 
\dot{x}_{n-1}  &amp;=&amp; x_n \\ 
\dot{x}_{n} &amp;=&amp; -a_{0}x_1 -a_1x_2 - \cdots  -a_{n-2}x_{n-1} -a_{n-1}x_{n} + b_0 u
\end{eqnarray*}$$<p>We then define the state vector</p>
$$\begin{equation}\mathbf{x}=[x_1,\ x_2,\ \ldots,\ x_n]^T\end{equation}$$<p></p>
<p>and the matrix form of the state equations are</p>
$$\begin{equation}\dot{\mathbf{x}} = \left[\begin{array}{ccccc}
  0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 \\
  -a_{0} &amp; -a_{1} &amp; -a_{2} &amp; \cdots &amp; -a_{n-1}
\end{array}\right]\mathbf{x}+\left[\begin{array}{c}
  0 \\
  0 \\
  0 \\
  \vdots \\
  1
\end{array}\right]u\end{equation}$$<p></p>
<p>The system matrix is in "<em>companion form</em>", so called because the coefficients in the final row are the same as for the differential equation. The output equation depends on the dependent variable of interest but the simplest is $y=x_1$ which gives the solution of the differential equation. Thus</p>
$$\begin{equation}y = [1,\ 0,\ 0,\ \ldots, 0] \mathbf{x}.\end{equation}$$<h3 id="Transfer-Function">Transfer Function<a class="anchor-link" href="#Transfer-Function"> </a></h3><p>The transfer function equivalent of this differential equation is obtained from the differential equation:</p>
$$\begin{equation}\frac{d^{n}y}{dt^{n}} + a_{n-1}\frac{d^{n-1}y}{dt^{n-1}}+a_{n-2}\frac{d^{n-2}y}{dt^{n-2}}+\cdots+a_1\frac{dy}{dt}+a_0 y = b_0 u\end{equation}$$<p></p>
<p>The transform of this equation, ignoring initial conditions, is</p>
$$\begin{equation}\left(s^n + a_{n-1}s^{n-1}+a_{n-2}s^{n-2}+\cdots+a_1s+a_0\right)Y(s) = b_0 U(s)\end{equation}$$<p></p>
<p>so the transfer function is</p>
$$\begin{equation}G(s) = \frac{Y(s)}{U(s)} = \frac{b_0}{s^n + a_{n-1}s^{n-1}+a_{n-2}s^{n-2}+\cdots+a_1s+a_0}.\end{equation}$$<p></p>
<p>Note that the numerator has no terms in $s$. We shall consider completely general case for both proper and strictly proper systems later.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Companion-Form">The Companion Form<a class="anchor-link" href="#The-Companion-Form"> </a></h2><p>We have just shown that a state space model for the system defined by the <strong>general differential equation</strong> was the <strong>companion form</strong>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="General-differential-equation">General differential equation<a class="anchor-link" href="#General-differential-equation"> </a></h3>$$\begin{equation}\frac{d^{n}y}{dt^{n}} +
a_{n-1}\frac{d^{n-1}y}{dt^{n-1}}+a_{n-2}\frac{d^{n-2}y}{dt^{n-2}}+\cdots+a_1\frac{dy}{dt}+a_0
y = b_0 u\end{equation}$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>or transfer function</p>
$$\begin{equation}
G(s) = \frac{Y(s)}{U(s)} = \frac{b_0}{s^n +
a_{n-1}s^{n-1}+a_{n-2}s^{n-2}+\cdots+a_1s+a_0}.\end{equation}$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The state variables in this model are the so-called "<em>phase variables</em>" $x_1 = y$,
$x_2 = dy/dt$, $\ldots$ $x_n = dy^{n-1}/dt^{n-1}$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Companion-Form">Companion Form<a class="anchor-link" href="#Companion-Form"> </a></h3>$$\begin{eqnarray*}
 \dot{\mathbf{x}} &amp;=&amp;
\left[\begin{array}{ccccc}
  0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 \\
  -a_{0} &amp; -a_{1} &amp; -a_{2} &amp; \cdots &amp; -a_{n-1}
\end{array}\right]\mathbf{x}+\left[\begin{array}{c}
  0 \\
  0 \\
  0 \\
  \vdots \\
  b_0
\end{array}\right]u\\
y &amp; = &amp; [1,\ 0,\ 0,\ \ldots, 0] \mathbf{x}.\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The structure of this state-space model is illustrated in Figure 1.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Figure-1:-Block-Diagram-of-Companion-Form">Figure 1: Block Diagram of Companion Form<a class="anchor-link" href="#Figure-1:-Block-Diagram-of-Companion-Form"> </a></h3><p><img src="pictures/companion1.png" alt="Block Diagram of Companion Form"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="System-with-a-Strictly-Proper-Transfer-Function">System with a Strictly Proper Transfer Function<a class="anchor-link" href="#System-with-a-Strictly-Proper-Transfer-Function"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let us consider the case of a system that has derivatives of the
input.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A strictly proper system has transfer function</p>
$$\begin{equation}G(s)=\frac{Y(s)}{U(s)} = \frac{b_ms^m +
b_{m-1}s^{m-1}+b_{m-2}s^{m-2}+\cdots+b_1s+b_0}{s^n +
a_{n-1}s^{n-1}+a_{n-2}s^{n-2}+\cdots+a_1s+a_0}\end{equation}$$<p></p>
<p>where $m&lt;n$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In class, we will show how this more general system converted into a state-space model.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Well, let us introduce an intermediate variable $W(s)$ and use this to
split the transfer function into two parts like so:</p>
$$\begin{equation}
W(s) = \frac{1}{s^n +
a_{n-1}s^{n-1}+a_{n-2}s^{n-2}+\cdots+a_1s+a_0}U(s)\end{equation}$$<p></p>
<p>and</p>
$$\begin{equation}
Y(s) = \left(b_ms^m +
b_{m-1}s^{m-1}+b_{m-2}s^{m-2}+\cdots+b_1s+b_0\right)W(s).\end{equation}$$<p>Now equation (2) has the same form as the system of equation (1) with $b_0 = 1$. So if we define our first phase
variable to be $X_1(s) = W(s)$ then the state matrix $\mathbf{A}$ will be the same as for the previous example and the input matrix $\mathbf{B} = \left[0, 0, \ldots, 1\right]^T$. To determine the output matrix $\mathbf{C}$ we inverse Laplace transform equation (3) to
get:</p>
$$\begin{equation}
y(t) = b_m\frac{d^m}{dt^m}w(t) +
b_{m-1}\frac{d^{m-1}}{dt^{m-1}}w(t)+\cdots+b_1\frac{d}{dt}w(t)+
b_0w(t).\end{equation}$$<p></p>
<p>Now, since by definition $x_1(t) = w(t)$, then</p>
$$\begin{equation}
y(t) = b_mx_{m+1}(t) + b_{m-1}x_m(t)+\cdots+b_1x_2(t)+
b_0x_1(t).\end{equation}$$<p></p>
<p>Where, in (5), substitutions have been made according to the definition of the phase variables.</p>
<p>The vector state equations are therefore:</p>
$$\begin{eqnarray*}
 \dot{\mathbf{x}} &amp;=&amp;
\left[\begin{array}{ccccc}
  0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 \\
  -a_{0} &amp; -a_{1} &amp; -a_{2} &amp; \cdots &amp; -a_{n-1}
\end{array}\right]\mathbf{x}+\left[\begin{array}{c}
  0 \\
  0 \\
  0 \\
  \vdots \\
  1
\end{array}\right]u\\
y &amp; = &amp; [b_0,\ b_1,\ \dots,\ b_{m-1}, b_m]
\mathbf{x}.\end{eqnarray*}$$<p></p>
<p>Note that the coefficients of the numerator appear in reverse order in the $\mathbf{C}$ matrix. The structure of
this system is illustrated in Figure 2 for the case $m=n-1$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Figure-2:-System-with-a-Strictly-Proper-Transfer-Function">Figure 2: System with a Strictly Proper Transfer Function<a class="anchor-link" href="#Figure-2:-System-with-a-Strictly-Proper-Transfer-Function"> </a></h3><p><img src="pictures/companion2.png" alt="System with a Strictly Proper Transfer Function"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="System-with-a-Proper-Transfer-Function">System with a Proper Transfer Function<a class="anchor-link" href="#System-with-a-Proper-Transfer-Function"> </a></h3><p>The general form of a transfer function of a proper single-input,
single-output system of order $n$ is</p>
$$\begin{equation}\frac{b_ns^n+b_{n-1}s^{n-1}+\cdots+b_1s + b_0}{s^n+a_{n-1}s^{n-1}+\cdots+a_1s + a_0}\end{equation}$$<p>In class, we will show how this system converted into state-space form.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An alternative form, obtained by dividing the numerator by the
denominator, is</p>
$$\begin{equation}b_n+\frac{(b_{n-1} - b_n a_{n-1})s^{n-1}+\cdots+(b_1 - b_n a_1)+(b_0 - b_n a_0)}{s^n+a_{n-1}s^{n-1}+\cdots+a_1s + a_0}.\end{equation}$$<p>If we define $d=b_n$ and the modified numerator coefficients are</p>
$$\begin{equation}c_j=b_j - b_n a_j,\ j=1,2,\ldots,n\end{equation}$$<p></p>
<p>then the transfer function may be re-written</p>
$$\begin{equation}d+\frac{c_{n-1}s^{n-1}+c_{n-2}s^{n-2}+\cdots+c_1s + c_n}{s^n+a_{n-1}s^{n-1}+\cdots++a_1s + a_0}.\end{equation}$$<p>Writing the transfer function in its functional form we have:</p>
$$\begin{equation}Y(s)=d U(s) +\frac{c_{n-1}s^{n-1}+c_{n-2}s^{n-2}+\cdots+c_1s +
c_0}{s^n+a_{n-1}s^{n-1}+\cdots+a_1s + a_0}U(s).\end{equation}$$<p></p>
<p>Performing a similar
analysis, as before, we obtain the state-equations for a proper system:</p>
$$\begin{aligned}
\dot{\mathbf{x}} &amp; = &amp; \left[\begin{array}{ccccc}
  0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 \\
  -a_{0} &amp; -a_{1} &amp; -a_{2} &amp; \cdots &amp; -a_{n-1}
\end{array}\right]\mathbf{x}+\left[\begin{array}{c}
  0 \\
  0 \\
  0 \\
  \vdots \\
  1
\end{array}\right]u\\
y &amp; = &amp; [c_0,\ c_1,\ \dots,\ c_{n-1}, c_n] \mathbf{x} + d
u.\end{aligned}$$<p></p>
<p>The block diagram for this system is illustrated in Figure 3.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Figure-3:-System-with-a-Proper-Transfer-Function">Figure 3: System with a Proper Transfer Function<a class="anchor-link" href="#Figure-3:-System-with-a-Proper-Transfer-Function"> </a></h3><p><img src="pictures/companion3.png" alt="System with a Proper Transfer Function"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example-1">Example 1<a class="anchor-link" href="#Example-1"> </a></h3><p>A system has transfer function</p>
$$\begin{equation}G(s)=\frac{Y(s)}{U(s)}=\frac{2s^3 + 16s^2 + 30s + 8}{s^3 + 7s^2 + 10s}\end{equation}$$<p>This system is "proper" because order of numerator equals order of denominator.</p>
<p>Determine the system state-space model in companion form.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Solution">Solution<a class="anchor-link" href="#Solution"> </a></h4><p>First divide the numerator into the denominator to get</p>
$$\begin{eqnarray*}
G(s)&amp;=&amp;\frac{2(s^3 + 7s^2 + 10s) + 2s^2 + 10s + 8}{s^3 + 7s^2 +
10s}\\ &amp;=&amp; \frac{2s^2 + 10s + 8}{s^3 + 7s^2 + 10s} +
2.\end{eqnarray*}$$<p>The companion form of the state matrices are</p>
$$\begin{eqnarray*}
\mathbf{A} &amp; = &amp; \left[\begin{array}{ccc}
  0 &amp; 1 &amp; 0 \\
  0 &amp; 0 &amp; 1 \\
  0 &amp; -10 &amp; -7
\end{array}\right]\ \mathbf{B}=\left[\begin{array}{c}
  0 \\
  0 \\
  1
\end{array}\right]\\ \mathbf{C} &amp; = &amp; \left[\begin{array}{ccc}
  8 &amp; 10 &amp; 2
\end{array}\right]\ \mathbf{D}=\left[2\right]\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="End-of-Pre-Class-Presentation">End of Pre-Class Presentation<a class="anchor-link" href="#End-of-Pre-Class-Presentation"> </a></h2><p>In class we will:</p>
<ul>
<li><p>Work through the three cases introduced here</p>
</li>
<li><p>Complete the worked example</p>
</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-2:-Other-Canonical-Forms">Part 2: Other Canonical Forms<a class="anchor-link" href="#Part-2:-Other-Canonical-Forms"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Controller and Observer Canonical Forms</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Normal form</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Jordan forms</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Controller-Canonical-Form">Controller Canonical Form<a class="anchor-link" href="#Controller-Canonical-Form"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If one defines a transfer function in , e.g. as shown in the slide entitled <strong>A Litte MATLAB</strong> below, the result of
converting the system into state-space form using MATLAB's <code>tf2ss</code> function is rather surprisingly not the companion form we have seen before.</p>
<p>Instead, the result is what is known as the <em>Controller Canonical Form</em>. This is still a companion form because the coefficients of the $\mathbf{A}$ and $\mathbf{C}$ matrices are the coefficients of the transfer function's denominator and numerator polynomials.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="A-Little-MATLAB">A Little MATLAB<a class="anchor-link" href="#A-Little-MATLAB"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let</p>
$$\begin{equation}G(s) =\frac{Y(s)}{U(s)} = \frac{s^2 + 7s + 2 }{s^3 + 9s^2 + 26s + 24}\end{equation}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">format </span><span class="s">compact</span><span class="p"></span>
<span class="n">num</span><span class="p">=[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span> <span class="n">den</span><span class="p">=[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">26</span> <span class="mi">24</span><span class="p">];</span>
<span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">]=</span><span class="n">tf2ss</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="n">den</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>A =
    -9   -26   -24
     1     0     0
     0     1     0
B =
     1
     0
     0
C =
     1     7     2
D =
     0
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Result:</p>
$$\begin{eqnarray*}
\dot{\mathbf{x}} &amp; = &amp;\left[\begin{array}{ccc}
  -9 &amp; -26 &amp; -24  \\
  1 &amp; 0 &amp; 0  \\
  0 &amp; 1  &amp; 0
 \end{array}\right]\mathbf{x}+\left[\begin{array}{c}
  1 \\
  0 \\
  0
\end{array}\right]u\\
y &amp; = &amp; [1,\ 7,\ 2] \mathbf{x}.\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The controller canonical form is simply obtained by re-ordering the phase variables as illustrated below.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Companion-Form">The Companion Form<a class="anchor-link" href="#The-Companion-Form"> </a></h3>$$\begin{eqnarray*}
 \left[\begin{array}{c}
  \dot{x}_{1} \\
  \dot{x}_{2} \\
  \vdots \\
  \dot{x}_{n-1} \\
  \dot{x}_n
\end{array}\right] &amp;=&amp; \left[\begin{array}{ccccc}
  0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 \\
  -a_{0} &amp; -a_{1} &amp; -a_{2} &amp; \cdots &amp; -a_{n-1}
\end{array}\right]\left[\begin{array}{c}
  {x}_{1} \\
  {x}_{2} \\
  \vdots \\
  {x}_{n-1} \\
  {x}_{n}
\end{array}\right]+\left[\begin{array}{c}
  0 \\
  0 \\
  \vdots \\
  0 \\
  1
\end{array}\right]u\\
y &amp; = &amp; [b_0,\ b_1,\ \dots,\ b_{n-2}, b_{n-1}][
  {x}_{1},\
  {x}_{2},\
  \ldots,\
  {x}_{n-1},\
  {x}_{n}]^T\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Controller-canonical-form:-Re-number-States">Controller canonical form: Re-number States<a class="anchor-link" href="#Controller-canonical-form:-Re-number-States"> </a></h3>$$\begin{eqnarray*}
 \left[\begin{array}{c}
  \dot{x}_{n} \\
  \dot{x}_{n-1} \\
  \vdots \\
  \dot{x}_{2} \\
  \dot{x}_{1}
\end{array}\right] &amp;=&amp; \left[\begin{array}{ccccc}
  0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 \\
  -a_{0} &amp; -a_{1} &amp; -a_{2} &amp; \cdots &amp; -a_{n-1}
\end{array}\right]\left[\begin{array}{c}
  {x}_{n} \\
  {x}_{n-1} \\
  \vdots \\
  {x}_{2} \\
  {x}_{1}
\end{array}\right]+\left[\begin{array}{c}
  0 \\
  0 \\
  \vdots \\
  0 \\
  1
\end{array}\right]u\\ y &amp; = &amp; [b_0,\ b_1,\ \dots,\ b_{n-2}, b_{n-1}]
\left[
  {x}_{n},\
  {x}_{n-1},\
  \ldots,\
  {x}_{2},\
  {x}_{1}
\right]^T\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The general form of the controller canonical state-space model is the as shown below.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Controller-canonical-form:-Re-Ordered-States">Controller canonical form: Re-Ordered States<a class="anchor-link" href="#Controller-canonical-form:-Re-Ordered-States"> </a></h3>$$\begin{eqnarray*}
 \left[\begin{array}{c}
  \dot{x}_{1} \\
  \dot{x}_{2} \\
  \vdots \\
  \dot{x}_{n-1} \\
  \dot{x}_{n}
\end{array}\right] &amp;=&amp; \left[\begin{array}{ccccc}
 -a_{n-1} &amp; -a_{n-2} &amp; \cdots &amp; -a_{1} &amp; -a_{0} \\
   1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\
  0 &amp; 1 &amp; \cdots &amp; 0 &amp; 0 \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
  0 &amp; 0 &amp; \cdots &amp; 1 &amp; 0
\end{array}\right]\left[\begin{array}{c}
  {x}_{1} \\
  {x}_{2} \\
  \vdots \\
  {x}_{n-1} \\
  {x}_{n}
\end{array}\right]+\left[\begin{array}{c}
  1 \\
  0 \\
  \vdots \\
  0 \\
  0
\end{array}\right]u\\ y &amp; = &amp; [b_{n-1},\ b_{n-2},\ \dots,\ b_{1}, b_{0}]
\left[
  {x}_{1},\
  {x}_{2},\
  \ldots,\
  {x}_{n-1},\
  {x}_{n}
\right]^T\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Figure-4:-Controller-Canonical-Form:-Block-Diagram">Figure 4: Controller Canonical Form: Block Diagram<a class="anchor-link" href="#Figure-4:-Controller-Canonical-Form:-Block-Diagram"> </a></h3><p><img src="pictures/ccanon.png" alt="Controller Canonical Form: Block Diagram"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Observer-Canonical-Form">Observer Canonical Form<a class="anchor-link" href="#Observer-Canonical-Form"> </a></h2><p>The observer canonical form is the "dual" of the controller canonical
form.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The state equations are shown below. Note that the $\mathbf{A}$
matrix is the transpose of the controller canonical form and that
$\mathbf{b}$ and $\mathbf{c}$ are the transposes of the $\mathbf{c}$ and
$\mathbf{b}$ matrices, respectively, of the controller canonical form.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Observer-canonical-form">Observer canonical form<a class="anchor-link" href="#Observer-canonical-form"> </a></h3>$$\begin{eqnarray*}
 \left[\begin{array}{c}
  \dot{x}_{1} \\
  \dot{x}_{2} \\
  \vdots \\
  \dot{x}_{n-1} \\
  \dot{x}_{n}
\end{array}\right] &amp;=&amp; \left[\begin{array}{ccccc}
 -a_{n-1} &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\
 -a_{n-2} &amp; 0 &amp; 1 &amp; \cdots &amp; 0 \\
 -a_{n-3} &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
 -a_{1} &amp; 0 &amp; \cdots &amp; 0 &amp; 1 \\
 -a_{0} &amp; 0 &amp; \cdots &amp; 0 &amp; 0
\end{array}\right]\left[\begin{array}{c}
  {x}_{1} \\
  {x}_{2} \\
  {x}_{3} \\
  \vdots \\
  {x}_{n-1} \\
  {x}_{n}
\end{array}\right]+\left[\begin{array}{c}
  b_{n-1} \\
  b_{n-2} \\
  b_{n-3} \\
  \vdots \\
  b_{1} \\
  b_0
\end{array}\right]u\\ y &amp; = &amp; [1,\ 0,\ 0,\ \ldots, 0]\left[
  {x}_{1},\
  {x}_{2},\
  \ldots,\
  {x}_{n-1},\
  {x}_{n}
\right]^T\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Figure-5:-Observer-Canonical-Form:-Block-Diagram">Figure 5: Observer Canonical Form: Block Diagram<a class="anchor-link" href="#Figure-5:-Observer-Canonical-Form:-Block-Diagram"> </a></h3><p><img src="pictures/ocanon.png" alt="Controller Canonical Form: Block Diagram"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example-2">Example 2<a class="anchor-link" href="#Example-2"> </a></h3><p>The system with transfer function</p>
$$\begin{equation}G(s)=\frac{Y(s)}{U(s)}=\frac{2s^3 + 16s^2 + 30s + 8}{s^3 + 7s^2 + 10s}\end{equation}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>was found, earlier, to have companion form</p>
$$\begin{eqnarray*}
\mathbf{A} &amp; = &amp; \left[\begin{array}{ccc}
  0 &amp; 1 &amp; 0 \\
  0 &amp; 0 &amp; 1 \\
  0 &amp; -10 &amp; -7
\end{array}\right]\ \mathbf{B}=\left[\begin{array}{c}
  0 \\
  0 \\
  1
\end{array}\right]\\ \mathbf{C} &amp; = &amp; \left[\begin{array}{ccc}
  8 &amp; 10 &amp; 2
\end{array}\right]\ \mathbf{D}=\left[2\right]\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Express this system in controller canonical and observer canonical
forms.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Solution">Solution<a class="anchor-link" href="#Solution"> </a></h3><p>The controller canonical form is obtained by re-ordering the state
variables:</p>
$$\begin{eqnarray*}
\mathbf{A} &amp; = &amp; \left[\begin{array}{ccc}
  -7 &amp; -10 &amp; 0 \\
  1 &amp; 0 &amp; 0 \\
  0 &amp; 1 &amp; 0
\end{array}\right]\ \mathbf{B}=\left[\begin{array}{c}
  1 \\
  0 \\
  0
\end{array}\right]\\ \mathbf{C} &amp; = &amp; \left[\begin{array}{ccc}
  2 &amp; 10 &amp; 8
\end{array}\right]\ \mathbf{D}=\left[2\right]\end{eqnarray*}$$<p></p>
<p>and the
observable canonical form is obtained by transposing the $\mathbf{A}$
matrix and letting $\mathbf{B} = \mathbf{C}^T$ and
$\mathbf{C}=\mathbf{B}^T$.</p>
$$\begin{eqnarray*}
\mathbf{A} &amp; = &amp; \left[\begin{array}{ccc}
  -7 &amp; 1 &amp; 0 \\
  -10 &amp; 0 &amp; 1 \\
  0 &amp; 0 &amp; 0
\end{array}\right]\ \mathbf{B}=\left[\begin{array}{c}
  2 \\
  10 \\
  8
\end{array}\right]\\ \mathbf{C} &amp; = &amp; \left[\begin{array}{ccc}
  1 &amp; 0 &amp; 0
\end{array}\right]\ \mathbf{D}=\left[2\right]\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="MATLAB-Code-for-Examples">MATLAB Code for Examples<a class="anchor-link" href="#MATLAB-Code-for-Examples"> </a></h3><p>We will show these in class.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Controller-canonical-companion-form">Controller canonical companion form<a class="anchor-link" href="#Controller-canonical-companion-form"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Acc</span> <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
<span class="n">Bcc</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span>
<span class="n">Ccc</span> <span class="p">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">];</span> <span class="n">D</span> <span class="p">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">Gcc</span> <span class="p">=</span> <span class="n">ss</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span><span class="n">Bcc</span><span class="p">,</span><span class="n">Ccc</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Gcc =
 
  A = 
        x1   x2   x3
   x1   -7  -10    0
   x2    1    0    0
   x3    0    1    0
 
  B = 
       u1
   x1   1
   x2   0
   x3   0
 
  C = 
       x1  x2  x3
   y1   2  10   8
 
  D = 
       u1
   y1   2
 
Continuous-time state-space model.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Observer-canonical-form">Observer canonical form<a class="anchor-link" href="#Observer-canonical-form"> </a></h4><p>To create the observer canonical form, we transpose some of the matrices</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Goc</span> <span class="p">=</span> <span class="n">ss</span><span class="p">(</span><span class="n">Acc</span><span class="o">&#39;</span><span class="p">,</span><span class="n">Ccc</span><span class="o">&#39;</span><span class="p">,</span><span class="n">Bcc</span><span class="o">&#39;</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Goc =
 
  A = 
        x1   x2   x3
   x1   -7    1    0
   x2  -10    0    1
   x3    0    0    0
 
  B = 
       u1
   x1   2
   x2  10
   x3   8
 
  C = 
       x1  x2  x3
   y1   1   0   0
 
  D = 
       u1
   y1   2
 
Continuous-time state-space model.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Companion-form">Companion form<a class="anchor-link" href="#Companion-form"> </a></h4><p>To obtain the companion form, some trickery is needed to re-order the controller
canonical state matrices:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="p">[</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">]=</span><span class="nb">size</span><span class="p">(</span><span class="n">Acc</span><span class="p">);</span> <span class="c">% n = m = 3 for the example</span>
<span class="n">Acf</span> <span class="p">=</span> <span class="n">Acc</span><span class="p">(</span><span class="n">n</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">);</span>
<span class="n">Bcf</span> <span class="p">=</span> <span class="n">Bcc</span><span class="p">(</span><span class="n">n</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,:);</span>
<span class="n">Ccf</span> <span class="p">=</span> <span class="n">Ccc</span><span class="p">(:,</span><span class="n">n</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The companion form is then created from the reordered matrices.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Gcf</span> <span class="p">=</span> <span class="n">ss</span><span class="p">(</span><span class="n">Acf</span><span class="p">,</span><span class="n">Bcf</span><span class="p">,</span><span class="n">Ccf</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Gcf =
 
  A = 
        x1   x2   x3
   x1    0    1    0
   x2    0    0    1
   x3    0  -10   -7
 
  B = 
       u1
   x1   0
   x2   0
   x3   1
 
  C = 
       x1  x2  x3
   y1   8  10   2
 
  D = 
       u1
   y1   2
 
Continuous-time state-space model.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="MATLAB's-built-in-canonical-form">MATLAB's built-in canonical form<a class="anchor-link" href="#MATLAB's-built-in-canonical-form"> </a></h4><p>This is none of the forms discussed. So for example if we convert the transfer function directly:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">num</span> <span class="p">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">8</span><span class="p">];</span>
<span class="n">den</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
<span class="n">G</span> <span class="p">=</span> <span class="n">tf</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="n">den</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
G =
 
  2 s^3 + 16 s^2 + 30 s + 8
  -------------------------
     s^3 + 7 s^2 + 10 s
 
Continuous-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then convert into state space using the <code>ss</code> function</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Gtf</span> <span class="p">=</span> <span class="n">ss</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Gtf =
 
  A = 
         x1    x2    x3
   x1    -7  -2.5     0
   x2     4     0     0
   x3     0  0.25     0
 
  B = 
       u1
   x1   4
   x2   0
   x3   0
 
  C = 
          x1     x2     x3
   y1    0.5  0.625      2
 
  D = 
       u1
   y1   2
 
Continuous-time state-space model.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is a canonical form known only to the Mathworks! The algorithm used to generate it presumably has some useful numerical properties.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="All-forms-represent-the-same-transfer-function!">All forms represent the same transfer function!<a class="anchor-link" href="#All-forms-represent-the-same-transfer-function!"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">G1</span> <span class="p">=</span> <span class="n">tf</span><span class="p">(</span><span class="n">Gtf</span><span class="p">)</span> <span class="c">% Mathworks tf-t--ss form</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
G1 =
 
  2 s^3 + 16 s^2 + 30 s + 8
  -------------------------
     s^3 + 7 s^2 + 10 s
 
Continuous-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">G2</span> <span class="p">=</span> <span class="n">tf</span><span class="p">(</span><span class="n">Gcc</span><span class="p">)</span> <span class="c">% Controller Canonical form</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
G2 =
 
  2 s^3 + 16 s^2 + 30 s + 8
  -------------------------
     s^3 + 7 s^2 + 10 s
 
Continuous-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">G3</span> <span class="p">=</span> <span class="n">tf</span><span class="p">(</span><span class="n">Goc</span><span class="p">)</span> <span class="c">% Observer Canonical Form</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
G3 =
 
  2 s^3 + 16 s^2 + 30 s + 8
  -------------------------
     s^3 + 7 s^2 + 10 s
 
Continuous-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">G4</span> <span class="p">=</span> <span class="n">tf</span><span class="p">(</span><span class="n">Gcf</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
G4 =
 
  2 s^3 + 16 s^2 + 30 s + 8
  -------------------------
     s^3 + 7 s^2 + 10 s
 
Continuous-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We now consider one final canonical form, the so-called "normal" or "parallel" form.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Normal-Canonical-Form">Normal Canonical Form<a class="anchor-link" href="#Normal-Canonical-Form"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The normal form of a state-space model isolates the characteristic values, also called the eigen values, or system poles, of the system.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If all the poles of a system are real and distinct then the transfer function may be written as a partial fraction expansion</p>
$$\begin{equation}G(s) = \frac{Y(s)}{U(s)} = \left\{\frac{r_1}{s-p_1} +
\frac{r_2}{s-p_2} + \cdots + \frac{r_n}{s-p_n} + d\right\}\end{equation}$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>we can develop a state-space model for each term:</p>
$$\begin{equation}Y(s)=\frac{r_i}{s-p_i}U(s).\end{equation}$$<p></p>
$$\begin{eqnarray*}
(s-p_i)Y(s) &amp; = &amp; r_i U(s)\\ \frac{d}{dt}y(t)-p_i y(t) &amp;=&amp; r_i
u(t).\end{eqnarray*}$$<p></p>
<p>If we let $x_i(t) = y(t)$ then</p>
$$\begin{eqnarray*}
\dot{x}_i &amp;=&amp; p_i x_i + r_i u \\ y &amp;=&amp; x_i\end{eqnarray*}$$<p></p>
<p>Thus, each partial fraction term may be represented by the block diagram shown in Figure 6.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Figure-6-State-Space-model-of-a-first-order-system">Figure 6 State-Space model of a first-order system<a class="anchor-link" href="#Figure-6-State-Space-model-of-a-first-order-system"> </a></h3>$$\begin{eqnarray*}
\dot{x}_i &amp;=&amp; p_i x_i + r_i u \\ y &amp;=&amp; x_i\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="pictures/sspole.png" alt="state-space model of a single pole"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thus, the total state-space model of the system is simply the sum of such terms as shown in Figure 7.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Figure-7-Normal-Canonical-Form:-Block-Diagram">Figure 7 Normal Canonical Form: Block Diagram<a class="anchor-link" href="#Figure-7-Normal-Canonical-Form:-Block-Diagram"> </a></h3><p><img src="pictures/normalcan.png" alt="Normal Canonical Form: Block Diagram"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Therefore the state space model for the whole system is as shown below.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Normal-Observable-Canonical-State-Space-Model">Normal Observable Canonical State-Space Model<a class="anchor-link" href="#Normal-Observable-Canonical-State-Space-Model"> </a></h3>$$\begin{eqnarray*}
 \mathbf{\dot{x}}&amp;=&amp;\left[\begin{array}{ccccc}
  p_1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; p_2 &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; 0 &amp; p_3 &amp; \cdots &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  0 &amp; 0 &amp; 0 &amp; \cdots &amp; p_n
\end{array}\right] \mathbf{x} + \left[\begin{array}{c}
  r_1 \\
  r_2 \\
  r_3 \\
  \vdots \\
  r_n
\end{array}\right] u\\ y &amp;=&amp; \left[1,\ 1,\ 1,\ \ldots,\ 1\right] \mathbf{x} + d u\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the residues of the partial fraction expansion $r_1,\ r_2,\ \ldots,\ r_n$ have been allocated to the input side of the block diagram and therefore to the input matrix in the state space model. This model, in which all the elements of the output matrix are unity, is called the "<em>Normal Observable Canonical Form</em>". It would be equally
valid to allocate the residues to the output matrix, leaving the elements of the input matrix as unity, this would be the "<em>Normal Controllable Canonical Form</em>" illustrated below.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Normal-Controllable-Canonical-State-Space-Model">Normal Controllable Canonical State-Space Model<a class="anchor-link" href="#Normal-Controllable-Canonical-State-Space-Model"> </a></h3>$$\begin{eqnarray*}
 \mathbf{\dot{x}}&amp;=&amp;\left[\begin{array}{ccccc}
  p_1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; p_2 &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; 0 &amp; p_3 &amp; \cdots &amp; 0 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  0 &amp; 0 &amp; 0 &amp; \cdots &amp; p_n
\end{array}\right] \mathbf{x} + \left[\begin{array}{c}
  1 \\
  1 \\
  1 \\
  \vdots \\
  1
\end{array}\right] u\\ y &amp;=&amp; \left[r_1,\ r_2,\ r_3,\ \ldots,\ r_n\right] \mathbf{x} + d u\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The most important property of the normal canonical model is that the $\mathbf{A}$ matrix is diagonal and that the elements on the diagonal are the eigenvalues of the system matrix. If you form the systemtransition matrix for this system each state response is simply of the form $r_i e^{p_i t}$, that is each state response is equal to the corresponding mode response<sup>1</sup>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example-3">Example 3<a class="anchor-link" href="#Example-3"> </a></h3><p>Determine the observer and controller normal canonical forms for the system examined earlier.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Solution">Solution<a class="anchor-link" href="#Solution"> </a></h4>$$\begin{eqnarray*}
G(s) &amp;=&amp; \frac{2s^3 + 16s^2 + 30s + 8}{s^3 + 7s^2 + 10s} \\
 &amp;=&amp;
\frac{2s^2 + 10s + 8}{s^3 + 7s^2 + 10s} + 2 \\
 &amp;=&amp; \frac{2s^2 + 10s + 8}{s(s+2)(s+5)} + 2 \\
 &amp;=&amp; \frac{4/5}{s} + \frac{2/3}{s+2} + \frac{8/15}{s+5} + 2
\\\end{eqnarray*}$$<p></p>
<p>The normal controllable canonical form therefore is:</p>
$$\begin{eqnarray*}
\mathbf{\dot{x}}&amp;=&amp;\left[\begin{array}{ccc}
  0 &amp; 0 &amp; 0  \\
  0 &amp; -2 &amp; 0  \\
  0 &amp; 0 &amp; -5  \\
 \end{array}\right] \mathbf{x} + \left[\begin{array}{c}
  4/5 \\
  2/3 \\
  8/15
\end{array}\right] u\\ y &amp;=&amp; \left[1,\ 1,\ 1\right] \mathbf{x} + 2 u\end{eqnarray*}$$<p>and the normal observable canonical form is:</p>
$$\begin{eqnarray*}
\mathbf{\dot{x}}&amp;=&amp;\left[\begin{array}{ccc}
  0 &amp; 0 &amp; 0  \\
  0 &amp; -2 &amp; 0  \\
  0 &amp; 0 &amp; -5  \\
 \end{array}\right] \mathbf{x} + \left[\begin{array}{c}
  1 \\
  1  \\
  1
\end{array}\right] u\\ y &amp;=&amp; \left[4/5,\ 2/3,\ 8/15\right] \mathbf{x} + 2
u\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Time-Response-from-Normal-Form">Time Response from Normal Form<a class="anchor-link" href="#Time-Response-from-Normal-Form"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that in the case of a system defined in <em>normal form</em>, because the $\mathbf{A}$ matrix is diagonal, the state equations are decoupled from each other and can be solved independently. This canonical form is useful for the solution of the state equations.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Given initial states $x_1(t)=x_{1}(0)$, $x_2(t)=x_2(0)$, etc at $t=0$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\begin{eqnarray*}
     sX_1 (s) - x_{1}(0)  &amp; = &amp; p_1 X_1 (s) + r_1 U(s) \\
     (s - p_1 )X_1 (s) &amp; = &amp; x_{1}(0)  + r_1 U(s) \\
     X_1 (s) &amp; = &amp; \frac{x_{1}(0)}{s - p_1 } + \frac{r_1 }{s - p_1 }U(s)
    \end{eqnarray*}$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Taking inverse Laplace transforms:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\begin{equation}x_1 = x_{1}(0)e^{p_1t}+r_1\int_0^tu(\tau)e^{p_1(t-\tau)}d\tau\end{equation}$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Repeated for the other states.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These are then combined through the output equation to give the solution for $y$:</p>
$$\begin{equation}y(t) = x_1(t) + x_2(t) + ... + x_n(t) + du(t).\end{equation}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="System-Response">System Response<a class="anchor-link" href="#System-Response"> </a></h3><p>Combine state responses through the output equation</p>
$$\begin{equation}y(t) = x_1(t) + x_2(t) + ... + x_n(t) + du(t)\end{equation}$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\begin{eqnarray*}
    y(t) &amp; = &amp; x_{1}(0)e^{p_1t}+r_1\int_0^tu(\tau)e^{p_1(t-\tau)}d\tau  \\
         &amp; + &amp;  x_{2}(0)e^{p_2t}+r_2\int_0^tu(\tau)e^{p_2(t-\tau)}d\tau \\
         &amp; \vdots &amp; \\
         &amp; + &amp; x_{n}(0)e^{p_nt}+r_n\int_0^tu(\tau)e^{p_n(t-\tau)}d\tau + du(t)\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Jordan-Forms">Jordan Forms<a class="anchor-link" href="#Jordan-Forms"> </a></h2><p>Are needed for the special cases of</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Systems with repeated poles</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Systems with complex poles</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These are discussed in the notes but will not be examined!</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="System-with-Repeated-Poles">System with Repeated Poles<a class="anchor-link" href="#System-with-Repeated-Poles"> </a></h2><p>If the transfer function has repeated poles, then the form of the model must be changed. The partial fraction expansion contains terms of the form</p>
$$\begin{equation}\frac{r_i}{s-p_i} + \frac{r_{i+1}}{(s-p_i)^2}.\end{equation}$$<p></p>
<p>This is most easily implemented using the <em>Normal Controllable Canonical Form</em> using a series connection of the
block diagram for the single pole $$\frac{1}{s-p_i}$$ as shown in Figure 8. By examination of this diagram it should be clear that the signal seen at point $A$ is</p>
$$\begin{equation}A(s) = \frac{r_i}{s-p_i}U(s)\end{equation}$$<p>and that at $B$ is</p>
$$\begin{equation}B(s) = \frac{1}{s-p_i}\times\frac{1}{s-p_i}\times r_{i+1} U(s)\end{equation}$$<p>as
required.</p>
<h3 id="Figure-8-Part-of-a-system-with-repeated-poles">Figure 8 Part of a system with repeated poles<a class="anchor-link" href="#Figure-8-Part-of-a-system-with-repeated-poles"> </a></h3><p><img src="pictures/jordanblock.png" alt="Part of a system with repeated poles"></p>
<p>For this portion of the state space model we have</p>
$$\begin{eqnarray*}
\left[\begin{array}{c}
  \dot{x}_i \\
  \dot{x}_{i+1}
\end{array}\right] &amp;=&amp; \left[\begin{array}{cc}
  p_i &amp; 1 \\
  0 &amp; p_i
\end{array}\right]\left[\begin{array}{c}
  x_i \\
  x_{i+1}
\end{array}\right] + \left[\begin{array}{c}
  0 \\
  1
\end{array}\right] u\\
y &amp; = &amp; \left[r_{i+1},\ r_i\right]\left[\begin{array}{c}
  x_i \\
  x_{i+1}
\end{array}\right].\end{eqnarray*}$$<p>By comparison of this result with the normal situation we see that the
state matrices (of the observer controllable canonical form) are
modified as follows.</p>
<ul>
<li><p>in $\mathbf{A}$</p>
<p>$$\left[\begin{array}{cc}</p>

<pre><code>p_i &amp; 0 \\
0 &amp; p_{i+1} \\
</code></pre>
<p>\end{array}\right] \rightarrow \left[\begin{array}{cc}</p>

<pre><code>p_i &amp; 1 \\
0 &amp; p_{i} \\
</code></pre>
<p>\end{array}\right];$$</p>
</li>
<li><p>in $\mathbf{B}$</p>
<p>$$\left[\begin{array}{c}</p>

<pre><code>1 \\
1  \\
</code></pre>
<p>\end{array}\right] \rightarrow \left[\begin{array}{c}</p>

<pre><code>0 \\
1 \\
</code></pre>
<p>\end{array}\right];$$</p>
</li>
<li><p>in $\mathbf{C}$</p>
<p>$$\left[\begin{array}{cc}</p>

<pre><code>r_i &amp; r_{i+1}\\
</code></pre>
<p>\end{array}\right] \rightarrow \left[\begin{array}{cc}</p>

<pre><code>r_{i+1} &amp; r_i\\
</code></pre>
<p>\end{array}\right].$$</p>
</li>
</ul>
<p>The block</p>
$$\begin{equation}\left[\begin{array}{cc}
    p_i &amp; 1 \\
    0 &amp; p_{i} \\
  \end{array}\right]\end{equation}$$<p>is known as a "<em>Jordan Block</em>". A matrix with one (or more) Jordan Blocks instead of a pure diagonal</p>
$$\begin{equation}\left[\begin{array}{cc}
    p_i &amp; 0 \\
    0 &amp; p_{i+1} \\
  \end{array}\right]\end{equation}$$<p>is in the "<em>Jordan Form</em>". The idea may be extended to systems with poles of higher multiplicity. For example for
the case where the multiplicity is 3 as in</p>
$$\begin{equation}\frac{1}{(s-p_i)^3}\end{equation}$$<p></p>
<p>the Jordan Block is</p>
$$\begin{equation}\left[\begin{array}{ccc}
    p_i &amp; 1 &amp; 0 \\
    0 &amp; p_{i} &amp; 1 \\
    0 &amp; 0 &amp; p_i
  \end{array}\right].\end{equation}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example-4">Example 4<a class="anchor-link" href="#Example-4"> </a></h3><p><strong>Not examined</strong></p>
<p>The system with transfer function</p>
$$\begin{eqnarray*}
G(s) &amp;=&amp; \frac{1}{s^3 + 4s^2 + 5s + 2}\\
&amp;=&amp; \frac{1}{(s+1)^2(s+2)} \\ &amp;=&amp; \frac{-1}{s+1} +
\frac{1}{(s+1)^2} + \frac{1}{s+2}.\end{eqnarray*}$$<p></p>
<p>The normal canonical form is therefore given by:</p>
$$\begin{eqnarray*}
\mathbf{A} &amp;=&amp; \left[\begin{array}{ccc}
  -1 &amp; 1 &amp; 0 \\
  0 &amp; -1 &amp; 0 \\
  0 &amp; 0 &amp; -2
\end{array}\right] \mathbf{B} = \left[\begin{array}{c}
  0 \\
  1 \\
  1
\end{array}\right]\\ \mathbf{C} &amp;=&amp; \left[\begin{array}{ccc}
  1 &amp; -1 &amp; 1
\end{array}\right] \mathbf{D} = \left[0\right]\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Normal-Canonical-Form-with-Complex-Poles">Normal Canonical Form with Complex Poles<a class="anchor-link" href="#Normal-Canonical-Form-with-Complex-Poles"> </a></h2><p>A system with complex poles will have a partial fraction expansion containing terms of the form</p>
$$\begin{equation}\frac{\Re\{ r_i\} + j\Im\{ r_i\}}{s - \Re\{p_i\} + j\Im\{p_i\}} + \frac{\Re\{r_i\} - j\Im\{ r_i\}}{s - \Re\{p_i\} - j\Im\{p_i\}}\end{equation}$$<p>(where the poles and the residuals both appear as complex conjugate pairs). We cannot implement these directly in state space form because the state matrices must have real coefficients to be realisable. However, the complex factors involved can be combined into a quadratic form and blocks replaced in the normal canonical form<sup>2</sup> as follows:</p>
<ul>
<li><p>in $\mathbf{A}$</p>
<p>$$\left[\begin{array}{cc}</p>

<pre><code>p_i &amp; 0 \\
0 &amp; p_{i+1} \\
</code></pre>
<p>\end{array}\right] \rightarrow \left[\begin{array}{cc}</p>

<pre><code>+\Re\{p_i\} &amp; +\Im\{p_i\} \\
-\Im\{p_i\} &amp; +\Re\{p_i\} \\
</code></pre>
<p>\end{array}\right];$$</p>
</li>
<li><p>in $\mathbf{B}$</p>
<p>$$\left[\begin{array}{c}</p>

<pre><code>1 \\
1  \\
</code></pre>
<p>\end{array}\right] \rightarrow \left[\begin{array}{c}</p>

<pre><code>0 \\
1 \\
</code></pre>
<p>\end{array}\right];$$</p>
</li>
<li><p>in $\mathbf{C}$</p>
<p>$$\left[\begin{array}{cc}</p>

<pre><code>r_i &amp; r_{i+1}\\
</code></pre>
<p>\end{array}\right] \rightarrow \left[\begin{array}{cc}</p>

<pre><code>2\Im\{r_{i}\} &amp; 2\Re\{r_i\}\\
</code></pre>
<p>\end{array}\right].$$</p>
</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example-5">Example 5<a class="anchor-link" href="#Example-5"> </a></h3><p>The system with transfer function</p>
$$\begin{eqnarray*}
G(s) &amp;=&amp; \frac{6s+6}{s^2 + 4s + 13}\\
&amp;=&amp; \frac{6(s+1)}{(s+2)^2 + 3^2} \\ &amp;=&amp;
\frac{6(s+1)}{(s+2+3j)(s+2-3j)}
\\ &amp;=&amp; \frac{3-j}{s+2+3j} + \frac{3-j}{s+2-3j}.\end{eqnarray*}$$<p></p>
<p>The normal canonical form is therefore given by:</p>
$$\begin{eqnarray*}
\mathbf{A} &amp;=&amp; \left[\begin{array}{cc}
  -2-3j &amp; 0 \\
  0 &amp; -2+3j
\end{array}\right] \mathbf{B} = \left[\begin{array}{c}
  1 \\
  1
\end{array}\right]\\ \mathbf{C} &amp;=&amp; \left[\begin{array}{cc}
  3-j &amp; 3+j
\end{array}\right] \mathbf{D} = \left[0\right]\end{eqnarray*}$$<p></p>
<p>But this is not realisable so instead we use</p>
$$\begin{eqnarray*}
\mathbf{A} &amp;=&amp; \left[\begin{array}{cc}
  -2 &amp; -3 \\
  3 &amp; -2
\end{array}\right] \mathbf{B} = \left[\begin{array}{c}
  0 \\
  1
\end{array}\right]\\ \mathbf{C} &amp;=&amp; \left[\begin{array}{cc}
  -2 &amp; -6
\end{array}\right] \mathbf{D} = \left[0\right].\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="End-of-Pre-Class-Presentation">End of Pre-Class Presentation<a class="anchor-link" href="#End-of-Pre-Class-Presentation"> </a></h2><p>In class we will work through the examples given here and if we have time we'll look at</p>
<ul>
<li><p>Examples of controllable and observable forms</p>
</li>
<li><p>MATLAB and canonical forms</p>
</li>
<li><p>Normal form</p>
</li>
<li><p>Time response of normal form</p>
</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Footnotes">Footnotes<a class="anchor-link" href="#Footnotes"> </a></h2><ol>
<li><p>The proof is left as an exercise.</p>
</li>
<li><p>The details are left as an exercise.</p>
</li>
</ol>

</div>
</div>
</div>
</div>

 


    </main>
    
            </div>
            <div class="c-textbook__footer" id="textbook_footer">
              
<nav class="c-page__nav">
  
    
    

    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/eglm03-textbook/07/3/tr4ss.html">
      〈 <span class="u-margin-right-tiny"></span> Time Response for State Space Models
    </a>
  

  
    

    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/eglm03-textbook/07/5/systransf.html">
      Transformation of States and Syste... <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

              <footer>
  <p class="footer">This page was created by <a href="https://www.swansea.ac.uk/staff/engineering/c.p.jobling/">Dr Chris Jobling</a> for <a href="https://www.swansea.ac.uk">Swansea University</a>.</p>
</footer>

            </div>

        </div>
      </main>
    </div>
  </body>
</html>
