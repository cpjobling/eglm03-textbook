<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Digital System Models and System Response</title>
  <meta name="description" content="        Digital System Models and System Response    Digital System Models and System Response Digital System Models The equivalent of the differential equat...">

  <link rel="canonical" href="https://cpjobling.github.io/eglm03-textbook/06/2/dsm.html">
  <link rel="alternate" type="application/rss+xml" title="EGLM03 Modern Control Systems" href="https://cpjobling.github.io/eglm03-textbook/feed.xml">

  <meta property="og:url"         content="https://cpjobling.github.io/eglm03-textbook/06/2/dsm.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Digital System Models and System Response" />
<meta property="og:description" content="        Digital System Models and System Response    Digital System Models and System Response Digital System Models The equivalent of the differential equat..." />
<meta property="og:image"       content="https://cpjobling.github.io/eglm03-textbook/images/logo/logo.png" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://cpjobling.github.io/eglm03-textbook/06/2/dsm.html",
  "headline": "Digital System Models and System Response",
  "datePublished": "2020-03-26T11:26:55+00:00",
  "dateModified": "2020-03-26T11:26:55+00:00",
  "description": "        Digital System Models and System Response    Digital System Models and System Response Digital System Models The equivalent of the differential equat...",
  "author": {
    "@type": "Person",
    "name": "Dr Chris P. Jobling"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://cpjobling.github.io/eglm03-textbook",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://cpjobling.github.io/eglm03-textbook",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/eglm03-textbook/assets/css/styles.css">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/eglm03-textbook/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    },
    
    // Number LaTeX-style equations
    "TeX": {
        equationNumbers: {
          autoNumber: "all"
        }
    }
    
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML' async></script>


  <!-- DOM updating function -->
  <script src="/eglm03-textbook/assets/js/page/dom-update.js"></script>

  <!-- Selectors for elements on the page -->
  <script src="/eglm03-textbook/assets/js/page/documentSelectors.js"></script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/eglm03-textbook';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script src="/eglm03-textbook/assets/js/page/anchors.js" async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->



  <!-- Load the auto-generating TOC (non-async otherwise the TOC won't load w/ turbolinks) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.8.1/tocbot.min.js" async></script>
  <script src="/eglm03-textbook/assets/js/page/tocbot.js"></script>

  <!-- Google analytics -->
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '');
</script>



  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/eglm03-textbook/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/eglm03-textbook/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/eglm03-textbook/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  

  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js" async></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>

  <!-- Load JS that depends on site variables -->
  <script src="/eglm03-textbook/assets/js/page/copy-button.js" async></script>

  <!-- Hide cell code -->
  <script src="/eglm03-textbook/assets/js/page/hide-cell.js" async></script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/eglm03-textbook/assets/css/styles.css",
        style: "#textbook_content {padding-top: 40px};",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList,
        documentTitle: "EGLM03 Modern Control Systems"
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- Include the ThebeLab config so it gets reloaded on each page -->
    <script type="text/x-thebe-config">{
    requestKernel: true,
    binderOptions: {
    repo: "YOUR-ORG/YOUR-REPO",
    ref: "gh-pages",
    },
    codeMirrorConfig: {
    theme: "abcdef",
    mode: ""
    },
    kernelOptions: {
    kernelName: "matlab",
    path: "content/06/2"
    }
}
</script>

    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://jupyterbook.org/"><img src="/eglm03-textbook/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" alt="textbook logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">EGLM03 Modern Control Systems</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="">
        <a class="c-sidebar__entry"
          href=".html"
        >
          
          
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/intro.html"
        >
          
          Introduction to this Module
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/background/index">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/background/index.html"
        >
          
          Background
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/background/rlocus/what_is_rlocus">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/background/rlocus/what_is_rlocus.html"
              >
                
                What is the root locus?
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/background/rlocus/what_does_the_rlocus_represent">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/background/rlocus/what_does_the_rlocus_represent.html"
              >
                
                What does the root locus represent?
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/background/rlocus/sketching_rules">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/background/rlocus/sketching_rules.html"
              >
                
                What are the rules for sketching a root locus?
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/01/modsim">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/01/modsim.html"
        >
          
            1.
          
          Systems Modelling and Simulation
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/02/ssntr">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/02/ssntr.html"
        >
          
            2.
          
          Steady-State and Transient Response
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/03/classical">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/03/classical.html"
        >
          
            3.
          
          Classical Control Systems Design
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/03/1/intro">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/03/1/intro.html"
              >
                
                  3.1
                
                Introducing phase-lead compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/03/2/velfb">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/03/2/velfb.html"
              >
                
                  3.2
                
                Introduction to Root Locus Design
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/03/3/pplusd">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/03/3/pplusd.html"
              >
                
                  3.3
                
                Proportional plus derivative compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/03/4/leadc">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/03/4/leadc.html"
              >
                
                  3.4
                
                Lead compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/03/5/analrloc">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/03/5/analrloc.html"
              >
                
                  3.5
                
                Analytical Root-Locus Design of Phase-Lead Compensators
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/03/6/lagc">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/03/6/lagc.html"
              >
                
                  3.6
                
                Lag compensation
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/04/pid">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/04/pid.html"
        >
          
            4.
          
          PID Compensation
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/04/0/intro">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/04/0/intro.html"
              >
                
                  4.1
                
                Introduction to PID Compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/04/1/zeigler">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/04/1/zeigler.html"
              >
                
                  4.2
                
                Zeigler-Nichols Tuning Algorithms
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/04/2/tuning">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/04/2/tuning.html"
              >
                
                  4.3
                
                Manually Tuning a PID compensator
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/04/3/analpid">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/04/3/analpid.html"
              >
                
                  4.4
                
                Analytical Design of a PID Compensator
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/04/4/autotune">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/04/4/autotune.html"
              >
                
                  4.5
                
                PID Autotuning in MATLAB
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/05/freqresp">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/05/freqresp.html"
        >
          
            5.
          
          Frequency Response Design
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/05/1/freqlead">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/05/1/freqlead.html"
              >
                
                  5.1
                
                Frequency Response Design of a Lead Compensator
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/05/2/freqlag">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/05/2/freqlag.html"
              >
                
                  5.2
                
                Frequency Response Design of a Lag Compensator
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/06/digital">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/06/digital.html"
        >
          
            6.
          
          Digital Control Systems
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/06/1/digi_intro">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/06/1/digi_intro.html"
              >
                
                  6.1
                
                Introduction to Digital Systems
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/06/2/dsm">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/06/2/dsm.html"
              >
                
                  6.2
                
                Digital System Models and System Response
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/06/3/cse">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/06/3/cse.html"
              >
                
                  6.3
                
                Continuous Systems Equivalence
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/06/4/digictrl">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/06/4/digictrl.html"
              >
                
                  6.4
                
                Introduction to Digital Control
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/07/index">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/07/index.html"
        >
          
            7.
          
          Modelling Systems in State-Space
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/07/1/intro2ss">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/07/1/intro2ss.html"
              >
                
                  7.1
                
                State-Space Models
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/07/2/tf4ss">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/07/2/tf4ss.html"
              >
                
                  7.2
                
                Laplace Transforms of State Space Models
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/07/3/tr4ss">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/07/3/tr4ss.html"
              >
                
                  7.3
                
                Time Response for State Space Models
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/07/4/canon">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/07/4/canon.html"
              >
                
                  7.4
                
                Canonical Forms
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/07/5/systransf">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/07/5/systransf.html"
              >
                
                  7.5
                
                Transformation of States and System Diagonalization
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/07/6/gensolution">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/07/6/gensolution.html"
              >
                
                  7.6
                
                The General Solution of LTI Systems
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/08/index">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/08/index.html"
        >
          
            8.
          
          State-Feedback Control
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/08/1/obsv_ctrl">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/08/1/obsv_ctrl.html"
              >
                
                  8.1
                
                Controllability and Observability
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/08/2/sfcontrol">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/08/2/sfcontrol.html"
              >
                
                  8.2
                
                State-Feedback Control
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/08/3/observers">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/08/3/observers.html"
              >
                
                  8.3
                
                State Observers
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/08/4/observer_controller">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/08/4/observer_controller.html"
              >
                
                  8.4
                
                Combined Observer and Controller
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/01/mattf">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/01/mattf.html"
        >
          
          Appendix A Defining Transfer Functions in MATLAB
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Homework</li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/homework/index">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/homework/index.html"
        >
          
          Homework Problems
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/revision/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/revision/problems.html"
              >
                
                Homework 1 - Revision
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/lead_compensation/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/lead_compensation/problems.html"
              >
                
                Homework 2 - Dominant Poles and Lead Compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/lag_compensation/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/lag_compensation/problems.html"
              >
                
                Homework 3 - Lag Compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/lag_lead_pid/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/lag_lead_pid/problems.html"
              >
                
                Homework 4 - Lag-Lead and PID Compensation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/freqresp/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/freqresp/problems.html"
              >
                
                Homework 5 - Frequency Response Cascade Compensator Design
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/digirev/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/digirev/problems.html"
              >
                
                Homework 6 - Digital Systems Revision
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/ss2tf/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/ss2tf/problems.html"
              >
                
                Homework 7 - Modelling Systems in Statespace
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/ssm/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/ssm/problems.html"
              >
                
                Homework 8 - State Space Modelling
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/homework/ppo/problems">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/homework/ppo/problems.html"
              >
                
                Homework 9 - Pole Placement and Observers
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Handouts</li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/handouts/csd/index">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/handouts/csd/index.html"
        >
          
          Control System Design Methods
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/1">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/1.html"
              >
                
                1. Aims of Control Systems Analysis and Design
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/2">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/2.html"
              >
                
                2. Design Methods
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/3">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/3.html"
              >
                
                3. Design Strategies
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/4">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/4.html"
              >
                
                4. Design Criteria
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/5">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/5.html"
              >
                
                5. Some Useful Design Curves
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/ack">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/ack.html"
              >
                
                Acknowledgements
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/handouts/csd/appendix">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/handouts/csd/appendix.html"
              >
                
                Appendix -- Transfer Function Plots for Typical Transfer Functions
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Setting up your own version of this book</li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="setup/index">
        <a class="c-sidebar__entry"
          href="/eglm03-textbook/setup/index.html"
        >
          
          Control System Design Methods
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/setup/jupyter">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/setup/jupyter.html"
              >
                
                About Jupyter notebooks
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/setup/python">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/setup/python.html"
              >
                
                Installing Python
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/setup/setup">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/setup/setup.html"
              >
                
                Setting up your MATLAB-Jupyter Computing Environment
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/setup/jupyter-book">
              <a class="c-sidebar__entry"
                href="/eglm03-textbook/setup/jupyter-book.html"
              >
                
                Setting up jupyter-book
              </a>
            </li>
            
            
          
        </ul>
      

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://jupyterbook.org">Jupyter Book</a></p>
</nav>

      
      <div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <div class="c-topbar__buttons">
    <button
      id="js-sidebar-toggle"
      class="hamburger hamburger--arrowalt is-active"
    >
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="buttons">



  
  
  
  


</div>

  </div>
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="sidebar__right">
    <header><h4 class="nav__title"><img src="/eglm03-textbook/assets/images/list-solid.svg" alt="Search" />   On this page</h4></header>
    <nav class="onthispage">
    </nav>
  </aside>
  <a href="/eglm03-textbook/search.html" class="topbar-right-button" id="search-button">
    <img src="/eglm03-textbook/assets/images/search-solid.svg" alt="Search" />
  </a>
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
                  <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Digital System Models and System Response</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Digital-System-Models-and-System-Response">Digital System Models and System Response<a class="anchor-link" href="#Digital-System-Models-and-System-Response"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Digital-System-Models">Digital System Models<a class="anchor-link" href="#Digital-System-Models"> </a></h2><p>The equivalent of the differential equation model for continuous systems is the difference
equation for digital systems.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Replacing the differential operator $\frac{d}{dt}$ by the advance
operator $\triangle$ gives the general form of the difference equation
as</p>
$$\begin{equation}
  \triangle^ny + a_{1}\triangle^{n-1}y + \ldots +  a_n y = b_0
  \triangle^n u + b_{1}\triangle^{n-1} u + \ldots + b_n u.\end{equation}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The equivalent of the differential equation model for continuous systems
is the difference equation for digital systems.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Difference-equation">Difference equation<a class="anchor-link" href="#Difference-equation"> </a></h3><p>Now, given the definition of the advance operator derived in a previous lecture</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\triangle^n v_k = v_{k+n}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>we can re-write equation (1) as
the <em>difference equation</em></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\begin{equation}
  y_{k+n} + a_{1}y_{k+n-1} + \ldots + a_n y_k = b_0
   u_{k+n} + b_{1} u_{k+n-1} + \ldots +  b_n u_k.\end{equation}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Difference-equation-in-terms-of-the-delay-operator">Difference equation in terms of the delay operator<a class="anchor-link" href="#Difference-equation-in-terms-of-the-delay-operator"> </a></h3><p>Unlike the differential equation, however, which is hardly ever expressed in an integral form, the difference equation is more usually expressed in terms of the delay operator $\nabla$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Applying the operator $\nabla^n$ to equation (1)
gives $$\begin{eqnarray}
y + a_{1}\nabla y + \ldots  + a_n \nabla^n y &amp;=&amp; b_0 u +
b_{1}\nabla u + \ldots +  b_n\nabla^n u\\
  y_{k} + a_{1}y_{k-1} + \ldots +  a_n y_{k-n}
   &amp;=&amp; b_0
   u_{k} + b_{1} u_{k-1} + \ldots + b_n u_{k-n}.
   \end{eqnarray}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#160;z-transform-of-difference-equation">&#160;z-transform of difference equation<a class="anchor-link" href="#&#160;z-transform-of-difference-equation"> </a></h3><p>Applying the $z$ transform directly to the difference equation with the delay operator
(3) gives</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\begin{eqnarray}
 Y + a_{1}z^{-1} Y + \ldots + a_n z^{-n} Y
&amp;=&amp; b_0 U + b_{1}z^{-1} U + \ldots + b_n z^{-n} U\nonumber\\ 
(1 + a_{1}z^{-1} + \ldots +  a_n z^{-n}) Y &amp;=&amp; (b_0 + b_{1}z^{-1} +
\ldots + b_n z^{-n}) U
   \end{eqnarray}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="z-Transfer-Function">z Transfer Function<a class="anchor-link" href="#z-Transfer-Function"> </a></h3><p>Given that $$(1 +
a_{1}z^{-1} + \ldots +  a_n z^{-n}) Y(z) = (b_0 + b_1 z^{-1} +
\ldots + b_n z^{-n}) U(z)$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The $z$ transfer function is
$$H(z) = \frac{Y(z)}{U(z)}=\frac{b_0 + b_{1}z^{-1} + \ldots + b_n
z^{-n}}{1 + a_1z^{-1} + \ldots + a_n z^{-n}}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A digital system in this general form is known as a "<em>pole-zero,
infinite impulse response, recursive auto-regressive moving average
digital filter(!)</em>"</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="z-Transfer-Function-(2)">z Transfer Function (2)<a class="anchor-link" href="#z-Transfer-Function-(2)"> </a></h3><p>If $b_1 = b_2 = \cdots = b_n = 0$ then the transfer function is
$$H(z) = \frac{b_0}{1 + a_1z^{-1} + \ldots + a_n z^{-n}}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A digital system in this form is known as an "<em>all pole, infinite
impulse response, recursive auto-regressive digital filter.</em>"</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="z-Transfer-Function-(3)">z Transfer Function (3)<a class="anchor-link" href="#z-Transfer-Function-(3)"> </a></h3><p>When $a_1 = a_2 = \cdots = a_n = 0$ then the transfer function is
$$H(z) = b_0 + b_{1}z^{-1} + \ldots + b_n
z^{-n}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A digital system in this form is known as an "<em>all zero, finite impulse
response, non recursive moving average digital filter.</em>"</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Other-forms-of-digital-transfer-function">Other forms of digital transfer function<a class="anchor-link" href="#Other-forms-of-digital-transfer-function"> </a></h3><p>The transfer function can also be expressed in the zero-pole-gain form</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$H(z) = \frac{k(z-z_1)(z-z_2)\cdots(z-z_n)}{(z-p_1)(z-p_2)\cdots(z-p_n)}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>and the partial fraction form</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$H(z) = \frac{r_1}{z-p_1}+\frac{r_2}{z-p_2}\cdots\frac{r_n}{z-p_n}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Canonical-Forms">Canonical Forms<a class="anchor-link" href="#Canonical-Forms"> </a></h3><p>With the transfer function written as
    $$H(z) = \frac{b_0 z^n + b_{n-1} z^{n-1} + \cdots + b_1 z + b_n}{z^n + a_1 z^{n-1} + \cdots + a_{n-1} z + b_n}$$
    there is a direct analogy with the general form of the continuous
    system transfer function with $s$ instead of $z$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This was implemented with the physically realistic integral operator
    $\int
    dt$ for which the digital equivalent is the delay operator $\nabla$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="End-of-Pre-Class-Presentation">End of Pre-Class Presentation<a class="anchor-link" href="#End-of-Pre-Class-Presentation"> </a></h2><p>This concludes the pre-class presentation.</p>
<p>In the class we will look at system response and compute the impulse and step responses of an example system.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Digital-System-Response">Digital System Response<a class="anchor-link" href="#Digital-System-Response"> </a></h2><p>As in the case of a continuous system, the response of a digital signal
comprises the sum of a free response and a forced response. The free
response is dependent on the initial conditions of a digital system
states, and as these are taken as zero here the free response is also
zero and will not be considered further.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Digital-System-Response">Digital System Response<a class="anchor-link" href="#Digital-System-Response"> </a></h3><p>The response of a
digital system with transfer function $H(z)$ to a digital input signal
$u$ is the digital output signal $y$ given in transform form as
$$\begin{equation}
  Y(z) =H(z) U(z)\end{equation}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The inverse transform needed to determine the digital system response is
obtained using the inverse z transform methods, e.g. polynomial division
and partial fraction expansion, discussed in a previous lecture.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Taking the inverse transform gives the digital
system response as $$\begin{equation}
  y_k = \mathcal{Z}^{-1}Y(z) = \mathcal{Z}^{-1} \left\{H(z)
  U(z)\right\}\end{equation}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Response-to-Singularity-Signals">Response to Singularity Signals<a class="anchor-link" href="#Response-to-Singularity-Signals"> </a></h2><p>The elemental singularity signals in a digital system response include
the digital impulse signal and the digital step input.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Impulse-response">Impulse response<a class="anchor-link" href="#Impulse-response"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Impulse-signal">Impulse signal<a class="anchor-link" href="#Impulse-signal"> </a></h4><p>The digital impulse
signal is given by $$\begin{equation}
  v = \delta = \{\delta_k\}\end{equation}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>where $\delta_0 = 1$ when $k = 0$, and
$\delta_k = 0$ otherwise.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Therefore the sequence for the impulse is
simply $$\delta_k = 1,\ 0,\ 0,\ 0,\ \ldots.$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The transform of the digital impulse signal is $$\begin{equation}
  V = \Delta = \sum_{k=0}^{\infty}\delta_k z^{-k} = 1\end{equation}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Example-1:-Impulse-Response-Calculate-the-impulse">Example 1: Impulse Response Calculate the impulse<a class="anchor-link" href="#Example-1:-Impulse-Response-Calculate-the-impulse"> </a></h4><p>response of the digital system with transfer function
$$H(z) = \frac{4z^2 - 16}{z^2 - 0.25}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Consider the system</p>
$$H(z) = \frac{4z^2 - 16}{z^2 - 0.25}$$<p></p>
<p>The impulse response will be</p>
$$Y(z) = H(z)\times 1 = \frac{4z^2 - 16}{z^2 - 0.25}$$<p>We shall determine this response using the partial fraction expansion.
$$\begin{eqnarray*}
Y(z) &amp;=&amp; \frac{4 - 16z^{-2}}{1 - 0.25 z^{-2}}\\
     &amp;=&amp; \frac{4(4 - 16z^{-2})}{4 - z^{-2}}\\
     &amp;=&amp; \frac{4(2 - 4z^{-1})(2 + 4z^{-1})}{(2 - z^{-1})(2 + z^{-1})}\end{eqnarray*}$$</p>
<p>Assuming a partial fraction expansion of the form</p>
$$Y(z) = \frac{A}{2 - z^{-1}} + \frac{B}{2 + z^{-1}} + C$$<p></p>
<p>we have</p>
$$\begin{eqnarray*}
 \frac{4(2 - 4z^{-1})(2 + 4z^{-1})}{(2 - z^{-1})(2 + z^{-1})}
     &amp;=&amp; \frac{A(2 + z^{-1}) + B(2 - z^{-1}) + C(2 - z^{-1})(2 + z^{-1})}{(2 - z^{-1})(2 + z^{-1})}\\
     16 - 64z^{-2} &amp;=&amp; 2A + Az^{-1} + 2B - Bz^{-1} + 4C - Cz^{-2}
 \end{eqnarray*}$$<p></p>
<p>Gathering terms and equating coefficients</p>
$$\begin{eqnarray}
16 &amp;=&amp; 2A +2B + 4C\\ 
0 &amp;=&amp; A - B\\ 
-64 &amp;=&amp; -C\end{eqnarray}$$<p></p>
<p>Hence
$$\begin{eqnarray}
C &amp;=&amp; 64\\ A &amp;=&amp; B\\ 16 &amp;=&amp; 4A + 256\\ A &amp;=&amp; B = -60\end{eqnarray}$$</p>
<p>Thus
$$\begin{eqnarray*}
    Y(z) &amp;=&amp; 64 -\frac{60}{2-z^{-1}}-\frac{60}{2+z^{-1}}\\
    &amp;=&amp; 64 -\frac{30}{1-1/2 z^{-1}}-\frac{30}{1+1/2 z^{-1}}\\
     y_k&amp; =&amp; \left\{64\delta_k - 30\left(\frac{1}{2}\right)^k - 30
\left(-\frac{1}{2}\right)^k\right\}\\
 &amp;=&amp; \left\{4,\ 0,\ -15,\ 0,\ -3.75,\ 0,\ -0.9375,\ \ldots
 \right\}\end{eqnarray*}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Step-response">Step response<a class="anchor-link" href="#Step-response"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-signal">Step signal<a class="anchor-link" href="#Step-signal"> </a></h4><p>The digital step signal
is $$\begin{equation}
  v = \epsilon = \{\epsilon_k\}\end{equation}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>where $\epsilon_k = 1$ when $k \ge 0$,
and $\epsilon_k = 0$ otherwise.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Therefore the sequence for the step is
simply $$\epsilon_k = 1,\ 1,\ 1,\ 1,\ \ldots.$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="z-transform-of-step-signal">z-transform of step signal<a class="anchor-link" href="#z-transform-of-step-signal"> </a></h4><p>The transform of the
digital step signal is $$\begin{eqnarray}
  V = E &amp;=&amp; \sum_{k=0}^{\infty}\epsilon_k z^{-k}\\
        &amp;=&amp; \sum_{k=0}^{\infty} z^{-k}\nonumber \\
        &amp;=&amp; 1 + z^{-1} + z^{-2} + z^{-3} + \cdots z^{-n} + \cdots \nonumber\\
        &amp;=&amp; \frac{1}{1-z^{-1}} = \frac{z}{z-1}.\end{eqnarray}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Example-2:-Step-Response">Example 2: Step Response<a class="anchor-link" href="#Example-2:-Step-Response"> </a></h4><p>Calculate the step response of the digital system with transfer function
$$H(z) = \frac{4z^2 - 16}{z^2 - 0.25}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The step response of the example system is</p>
$$Y(z) = H(z)\times \frac{z}{z-1} = \frac{z(4z^2 - 16)}{(z-1)(z^2 - 0.25)}$$<p>We shall determine this response using the partial fraction expansion.</p>
$$\begin{eqnarray*}
Y(z) &amp;=&amp; \frac{4z^3 - 16z}{z^3 - z^2 - 0.25z + 0.25}\\
 &amp;=&amp; \frac{4 - 16z^{-2}}{1 - z^{-1} - 0.25z^{-2} + 0.25z^{-3}}\\\end{eqnarray*}$$<p>Earlier we showed that the result of the partial fraction expansion was</p>
$$\frac{30}{1-1/2 z^{-1}} - \frac{10}{1+1/2z^{-1}} -
\frac{16}{1-z^{-1}}$$<p>and the corresponding sequence is</p>
$$y_k = \left\{30(1/2)^k -10(-1/2)^k -16\epsilon_k\right\}.$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Computing-Digital-System-Responses-with-MATLAB">Computing Digital System Responses with MATLAB<a class="anchor-link" href="#Computing-Digital-System-Responses-with-MATLAB"> </a></h2><p>We will run this part of the presentation in class. There is an executable version as a MATLAB Live Script available as <a href="matlab/digiresp.mlx">digiresp.mlx</a>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Control-System-Toolbox-Help">Control System Toolbox Help<a class="anchor-link" href="#Control-System-Toolbox-Help"> </a></h3><p>What functions do we have in the controls system toolbox?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">doc </span><span class="s">control</span><span class="p"></span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Modelling">Modelling<a class="anchor-link" href="#Modelling"> </a></h4><p>Modeling looks likely</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">help </span><span class="s">ctrlmodels</span><span class="p"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>  Control System Toolbox -- Linear models.
 
  Model objects.
    InputOutputModel - Overview of input/output model objects.
    DynamicSystem    - Overview of dynamic system objects.
    lti              - Overview of linear time-invariant system objects.
    &lt;a href=&#34;matlab:help InputOutputModel/get&#34;&gt;get&lt;/a&gt;              - Access properties of model object.
    &lt;a href=&#34;matlab:help InputOutputModel/set&#34;&gt;set&lt;/a&gt;              - Set/modify properties of model object.
 
  Numeric LTI models.
    numlti           - Overview of numeric LTI models.
    tf               - Create or convert to transfer function model.
    filt             - Create digital filter.
    zpk              - Create or convert to zero/pole/gain model.
    ss               - Create or convert to state-space model.
    dss              - Create descriptor state-space model.
    rss              - Create random continuous-time state-space model.
    drss             - Create random discrete-time state-space model.
    pid              - Create 1-DOF PID controller in parallel form.
    pid2             - Create 2-DOF PID controller in parallel form.
    pidstd           - Create 1-DOF PID controller in standard form.
    pidstd2          - Create 2-DOF PID controller in standard form.
    frd              - Create or convert to frequency-response-data model.
    chgFreqUnit      - Change frequency vector units in FRD model.
 
  Generalized LTI models.
    genlti           - Overview of generalized LTI models.
    ControlDesignBlock - Overview of special blocks for analysis/tuning.
    AnalysisPoint    - Point of interest for analysis/tuning.
    genmat           - Generalized matrix.
    genss            - Generalized state-space model.
    genfrd           - Generalized FRD model.
    getValue         - Evaluate generalized model.
    getBlockValue    - Get value of Control Design Block.
    setBlockValue    - Modify value of Control Design Block.
    showBlockValue   - Display Control Design Block values.
    getPoints        - Get analysis point locations.
    getLoopTransfer  - Compute open-loop transfer function.
    getIOTransfer    - Compute closed-loop transfer function.
    getSensitivity   - Compute sensitivity function.
    getCompSensitivity - Compute complementary sensitivity function.
    replaceBlock     - Replace block by value or by another block. 
    sampleBlock      - Sample Control Design Blocks.
    rsampleBlock     - Randomly sample Control Design Blocks.
    
  Time delays.
    tf/exp           - Create pure continuous-time delays.
    delayss          - Create state-space models with delayed terms.
    setDelayModel    - Specify internal delay model (state space only).
    getDelayModel    - Access internal delay model (state space only).
    &lt;a href=&#34;matlab:help InputOutputModel/hasdelay&#34;&gt;hasdelay&lt;/a&gt;         - True for models with time delays.
    totaldelay       - Total delay between each input/output pair.
    absorbDelay      - Replace delays by poles at z=0 or phase shift.
    pade             - Pade approximation of continuous-time delays.
    thiran           - Thiran approximation of fractional delays.
 
  Arrays of models.
    stack            - Stack models along some array dimension.
    &lt;a href=&#34;matlab:help InputOutputModel/nmodels&#34;&gt;nmodels&lt;/a&gt;          - Number of models in model array.
    &lt;a href=&#34;matlab:help InputOutputModel/nmodels&#34;&gt;reshape&lt;/a&gt;          - Reshape model array.
    &lt;a href=&#34;matlab:help InputOutputModel/nmodels&#34;&gt;permute&lt;/a&gt;          - Permute model array dimensions.
    voidModel        - Mark missing or irrelevant models in model array.
 
  Data extraction.
    tfdata           - Extract numerators and denominators.
    zpkdata          - Extract zero/pole/gain data.
    ssdata           - Extract state-space matrices.
    dssdata          - Extract matrices of descriptor state-space model.
    frdata           - Extract frequency response data.
    piddata, piddata2        - Extract PID gains in parallel form.
    pidstddata, pidstddata2  - Extract PID gains in standard form.
 
  Block diagram modeling.
    append           - Aggregate models by appending inputs and outputs.
    parallel         - Connect models in parallel.
    series           - Connect models in series.
    feedback         - Connect models with a feedback loop.
    lft              - Generalized feedback interconnection.
    connect          - Arbitrary block-diagram interconnection.
    sumblk           - Specify summing junction (for use with CONNECT).
    strseq           - Builds sequence of indexed strings (for I/O naming).
 
  Model transformation.
    c2d              - Continuous to discrete conversion.
    d2c              - Discrete to continuous conversion.
    d2d              - Resample discrete-time model.
    upsample         - Upsample discrete-time systems.
    chgTimeUnit      - Change time units.
    imp2exp          - Implicit to explicit conversion.
    augstate         - Augment output by appending states.
    ss2ss            - State coordinate transformation.
    canon            - Canonical forms of state-space model.
    prescale         - Optimal scaling of state-space model.
    &lt;a href=&#34;matlab:help ss/xperm&#34;&gt;xperm&lt;/a&gt;            - Reorder states in state-space model.
 
  Model simplification.
    minreal          - Minimal realization and pole/zero cancellation.
    sminreal         - Structurally minimal state-space realization.
    hsvd             - Hankel singular values (state contributions)
    balred           - Reduced-order approximations of linear models.
    balreal          - Gramian-based input/output balancing.
    modred           - Model order reduction.
    modelReducer     - Model reduction app.
 
  Model algebra.
    &lt;a href=&#34;matlab:help InputOutputModel/plus&#34;&gt;+&lt;/a&gt;, &lt;a href=&#34;matlab:help InputOutputModel/minus&#34;&gt;-&lt;/a&gt;             - Add and subtract models (parallel connection).
    &lt;a href=&#34;matlab:help InputOutputModel/mtimes&#34;&gt;*&lt;/a&gt;                - Multiply models (series connection).
    &lt;a href=&#34;matlab:help InputOutputModel/mldivide&#34;&gt;\&lt;/a&gt;                - Left divide -- sys1\sys2 means inv(sys1)*sys2.
    &lt;a href=&#34;matlab:help InputOutputModel/mrdivide&#34;&gt;/&lt;/a&gt;                - Right divide -- sys1/sys2 means sys1*inv(sys2).
    &lt;a href=&#34;matlab:help InputOutputModel/mpower&#34;&gt;^&lt;/a&gt;                - Powers of a model.
    &lt;a href=&#34;matlab:help InputOutputModel/transpose&#34;&gt;.&#39;&lt;/a&gt;               - Transposition of input/output map.
    &lt;a href=&#34;matlab:help InputOutputModel/ctranspose&#34;&gt;&#39;&lt;/a&gt;                - Pertranspose H(s) to H(-s).&#39; or H(z) to H(1/z).&#39;
    &lt;a href=&#34;matlab:help DynamicSystem/times&#34;&gt;.*&lt;/a&gt;               - Element-by-element multiplication.
    &lt;a href=&#34;matlab:help InputOutputModel/horzcat&#34;&gt;[,]&lt;/a&gt;, &lt;a href=&#34;matlab:help InputOutputModel/vertcat&#34;&gt;[;]&lt;/a&gt;         - Concatenate models along inputs or outputs.
    &lt;a href=&#34;matlab:help InputOutputModel/inv&#34;&gt;inv&lt;/a&gt;              - Inverse of input/output model.
    &lt;a href=&#34;matlab:help InputOutputModel/conj&#34;&gt;conj&lt;/a&gt;             - Complex conjugation of model coefficients.
    frd/fcat         - Merge frequency responses.
    frd/fselect      - Select frequency range or frequency points.
    frd/abs          - Entrywise magnitude of the frequency response.
    frd/real         - Real part of the frequency response.
    frd/imag         - Imaginary part of the frequency response.
    frd/interp       - Interpolate frequency response data.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Transfer-function">Transfer function<a class="anchor-link" href="#Transfer-function"> </a></h4><p>From this, the transfer function looks likely</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">help </span><span class="s">tf</span><span class="p"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> TF  Construct transfer function or convert to transfer function.
 
   Construction:
     SYS = TF(NUM,DEN) creates a continuous-time transfer function SYS with
     numerator NUM and denominator DEN. SYS is an object of type TF when
     NUM,DEN are numeric arrays, of type GENSS when NUM,DEN depend on tunable
     parameters (see REALP and GENMAT), and of type USS when NUM,DEN are
     uncertain (requires Robust Control Toolbox).
 
     SYS = TF(NUM,DEN,TS) creates a discrete-time transfer function with
     sample time TS (set TS=-1 if the sample time is undetermined).
 
     S = TF(&#39;s&#39;) specifies the transfer function H(s) = s (Laplace variable).
     Z = TF(&#39;z&#39;,TS) specifies H(z) = z with sample time TS.
     You can then specify transfer functions directly as expressions in S
     or Z, for example,
        s = tf(&#39;s&#39;);  H = exp(-s)*(s+1)/(s^2+3*s+1)
 
     SYS = TF creates an empty TF object.
     SYS = TF(M) specifies a static gain matrix M.
 
     You can set additional model properties by using name/value pairs.
     For example,
        sys = tf(1,[1 2 5],0.1,&#39;Variable&#39;,&#39;q&#39;,&#39;IODelay&#39;,3)
     also sets the variable and transport delay. Type &#34;properties(tf)&#34;
     for a complete list of model properties, and type
        help tf.&lt;PropertyName&gt;
     for help on a particular property. For example, &#34;help tf.Variable&#34;
     provides information about the &#34;Variable&#34; property.
 
     By default, transfer functions are displayed as functions of &#39;s&#39; or &#39;z&#39;.
     Alternatively, you can use the variable &#39;p&#39; in continuous time and the
     variables &#39;z^-1&#39;, &#39;q&#39;, or &#39;q^-1&#39; in discrete time by modifying the
     &#34;Variable&#34; property.
 
   Data format:
     For SISO models, NUM and DEN are row vectors listing the numerator
     and denominator coefficients in descending powers of s,p,z,q or in
     ascending powers of z^-1 (DSP convention). For example,
        sys = tf([1 2],[1 0 10])
     specifies the transfer function (s+2)/(s^2+10) while
        sys = tf([1 2],[1 5 10],0.1,&#39;Variable&#39;,&#39;z^-1&#39;)
     specifies (1 + 2 z^-1)/(1 + 5 z^-1 + 10 z^-2).
 
     For MIMO models with NY outputs and NU inputs, NUM and DEN are
     NY-by-NU cell arrays of row vectors where NUM{i,j} and DEN{i,j}
     specify the transfer function from input j to output i. For example,
        H = tf( {-5 ; [1 -5 6]} , {[1 -1] ; [1 1 0]})
     specifies the two-output, one-input transfer function
        [     -5 /(s-1)      ]
        [ (s^2-5s+6)/(s^2+s) ]
 
   Arrays of transfer functions:
     You can create arrays of transfer functions by using ND cell arrays
     for NUM and DEN above. For example, if NUM and DEN are cell arrays
     of size [NY NU 3 4], then
        SYS = TF(NUM,DEN)
     creates the 3-by-4 array of transfer functions
        SYS(:,:,k,m) = TF(NUM(:,:,k,m),DEN(:,:,k,m)),  k=1:3,  m=1:4.
     Each of these transfer functions has NY outputs and NU inputs.
 
     To pre-allocate an array of zero transfer functions with NY outputs
     and NU inputs, use the syntax
        SYS = TF(ZEROS([NY NU k1 k2...])) .
 
   Conversion:
     SYS = TF(SYS) converts any dynamic system SYS to the transfer function
     representation. The resulting SYS is always of class TF.
 
   See also TF/EXP, FILT, TFDATA, ZPK, SS, FRD, GENSS, USS, DYNAMICSYSTEM.

    Reference page in Doc Center
       doc tf

    Other functions named tf

       DynamicSystem/tf    StaticModel/tf

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Digital-transfer-function-block">Digital transfer function block<a class="anchor-link" href="#Digital-transfer-function-block"> </a></h4><p>It seems that that the third argument is sampling period. Set this to -1 for "unspecified".</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">H</span> <span class="p">=</span> <span class="n">tf</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">],</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
H =
 
  4 z^2 - 16
  ----------
  z^2 - 0.25
 
Sample time: unspecified
Discrete-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Step-Response">Step Response<a class="anchor-link" href="#Step-Response"> </a></h3><p>Now do a step response</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">step</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/06/2/dsm_55_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What about the sequence values?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">ys</span> <span class="p">=</span> <span class="n">step</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
ys =

    4.0000
    4.0000
  -11.0000
  -11.0000
  -14.7500
  -14.7500
  -15.6875
  -15.6875
  -15.9219
  -15.9219
  -15.9805
  -15.9805
  -15.9951
  -15.9951
  -15.9988
  -15.9988
  -15.9997
  -15.9997
  -15.9999
  -15.9999
  -16.0000

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Does the sequence match the theory?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Impulse-Response">Impulse Response<a class="anchor-link" href="#Impulse-Response"> </a></h3><p>How about impulse response?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">impulse</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/06/2/dsm_60_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The plot isn't quite right -- it's a "hold-equivalent" result. We don't know values between sampling instants.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sequence?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">yi</span> <span class="p">=</span> <span class="n">impulse</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
yi =

    4.0000
         0
  -15.0000
         0
   -3.7500
         0
   -0.9375
         0
   -0.2344
         0
   -0.0586
         0
   -0.0146
         0
   -0.0037
         0
   -0.0009
         0
   -0.0002
         0
   -0.0001

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Stem-plot">Stem plot<a class="anchor-link" href="#Stem-plot"> </a></h4><p>To plot this properly, we use a stem plot</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">stem</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/06/2/dsm_65_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Step-response-as-stem-plot">Step response as stem plot<a class="anchor-link" href="#Step-response-as-stem-plot"> </a></h4><p>Should do same for step response too</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">stem</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/06/2/dsm_67_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Partial-fractions">Partial fractions<a class="anchor-link" href="#Partial-fractions"> </a></h3><p>Can we use partial fractions for inverse z transforms?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">help </span><span class="s">residue</span><span class="p"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> RESIDUE Partial-fraction expansion (residues).
    [R,P,K] = RESIDUE(B,A) finds the residues, poles and direct term of
    a partial fraction expansion of the ratio of two polynomials B(s)/A(s).
    If there are no multiple roots,
       B(s)       R(1)       R(2)             R(n)
       ----  =  -------- + -------- + ... + -------- + K(s)
       A(s)     s - P(1)   s - P(2)         s - P(n)
    Vectors B and A specify the coefficients of the numerator and
    denominator polynomials in descending powers of s.  The residues
    are returned in the column vector R, the pole locations in column
    vector P, and the direct terms in row vector K.  The number of
    poles is n = length(A)-1 = length(R) = length(P). The direct term
    coefficient vector is empty if length(B) &lt; length(A), otherwise
    length(K) = length(B)-length(A)+1.
 
    If P(j) = ... = P(j+m-1) is a pole of multplicity m, then the
    expansion includes terms of the form
                 R(j)        R(j+1)                R(j+m-1)
               -------- + ------------   + ... + ------------
               s - P(j)   (s - P(j))^2           (s - P(j))^m
 
    [B,A] = RESIDUE(R,P,K), with 3 input arguments and 2 output arguments,
    converts the partial fraction expansion back to the polynomials with
    coefficients in B and A.
 
    Warning: Numerically, the partial fraction expansion of a ratio of
    polynomials represents an ill-posed problem.  If the denominator
    polynomial, A(s), is near a polynomial with multiple roots, then
    small changes in the data, including roundoff errors, can make
    arbitrarily large changes in the resulting poles and residues.
    Problem formulations making use of state-space or zero-pole
    representations are preferable.
 
    Class support for inputs B,A,R:
       float: double, single
 
    See also POLY, ROOTS, DECONV.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="PFE-for-for-inverse-z-transform-of-impulse-response">PFE for for inverse z-transform of impulse response<a class="anchor-link" href="#PFE-for-for-inverse-z-transform-of-impulse-response"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">help </span><span class="s">residue</span><span class="p"></span>
<span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="p">=</span> <span class="n">residue</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">16</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.25</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> RESIDUE Partial-fraction expansion (residues).
    [R,P,K] = RESIDUE(B,A) finds the residues, poles and direct term of
    a partial fraction expansion of the ratio of two polynomials B(s)/A(s).
    If there are no multiple roots,
       B(s)       R(1)       R(2)             R(n)
       ----  =  -------- + -------- + ... + -------- + K(s)
       A(s)     s - P(1)   s - P(2)         s - P(n)
    Vectors B and A specify the coefficients of the numerator and
    denominator polynomials in descending powers of s.  The residues
    are returned in the column vector R, the pole locations in column
    vector P, and the direct terms in row vector K.  The number of
    poles is n = length(A)-1 = length(R) = length(P). The direct term
    coefficient vector is empty if length(B) &lt; length(A), otherwise
    length(K) = length(B)-length(A)+1.
 
    If P(j) = ... = P(j+m-1) is a pole of multplicity m, then the
    expansion includes terms of the form
                 R(j)        R(j+1)                R(j+m-1)
               -------- + ------------   + ... + ------------
               s - P(j)   (s - P(j))^2           (s - P(j))^m
 
    [B,A] = RESIDUE(R,P,K), with 3 input arguments and 2 output arguments,
    converts the partial fraction expansion back to the polynomials with
    coefficients in B and A.
 
    Warning: Numerically, the partial fraction expansion of a ratio of
    polynomials represents an ill-posed problem.  If the denominator
    polynomial, A(s), is near a polynomial with multiple roots, then
    small changes in the data, including roundoff errors, can make
    arbitrarily large changes in the resulting poles and residues.
    Problem formulations making use of state-space or zero-pole
    representations are preferable.
 
    Class support for inputs B,A,R:
       float: double, single
 
    See also POLY, ROOTS, DECONV.


r =

   -15
    15


p =

    0.5000
   -0.5000


k =

     4

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="PFE-for-inverse-z-transform-for-step-response">PFE for inverse z-transform for step response<a class="anchor-link" href="#PFE-for-inverse-z-transform-for-step-response"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="p">=</span> <span class="n">residue</span><span class="p">(</span><span class="n">conv</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">16</span><span class="p">]),</span><span class="n">conv</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.25</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
r =

  -16.0000
   15.0000
    5.0000


p =

    1.0000
    0.5000
   -0.5000


k =

     4

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Do these results match the theory?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Another-approach">Another approach<a class="anchor-link" href="#Another-approach"> </a></h4><p>Use LTI block to define the TF then extract num/den for PFE</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">U</span> <span class="p">=</span> <span class="n">tf</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Y</span> <span class="p">=</span> <span class="n">series</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
U =
 
    z
  -----
  z - 1
 
Sample time: unspecified
Discrete-time transfer function.


Y =
 
        4 z^3 - 16 z
  -------------------------
  z^3 - z^2 - 0.25 z + 0.25
 
Sample time: unspecified
Discrete-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>extract numerator &amp; denominator</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="p">[</span><span class="n">num</span><span class="p">,</span><span class="n">den</span><span class="p">]</span> <span class="p">=</span> <span class="n">tfdata</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="s">&#39;v&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
num =

     4     0   -16     0


den =

    1.0000   -1.0000   -0.2500    0.2500

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>get pfe</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]=</span><span class="n">residue</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="n">den</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
r =

  -16.0000
   15.0000
    5.0000


p =

    1.0000
    0.5000
   -0.5000


k =

     4

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Simulink-Model">Simulink Model<a class="anchor-link" href="#Simulink-Model"> </a></h3><p>A simulink model of the digital implementation is here <a href="matlab/digiresp.slx">digiresp.slx</a>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">cd </span><span class="s">matlab</span><span class="p"></span>
<span class="n">digiresp_model</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="pictures/simulink.png" alt="digital response model in simulink"></p>
<p>Note that in Simulink, you use the ZOH both as an ADC and DAC operator. The z-transfer function block is used for the digital transfer function.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Response">Response<a class="anchor-link" href="#Response"> </a></h4><p><img src="pictures/resp.png" alt="response"></p>

</div>
</div>
</div>
</div>

 


    </main>
    
            </div>
            <div class="c-textbook__footer" id="textbook_footer">
              
<nav class="c-page__nav">
  
    
    

    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/eglm03-textbook/06/1/digi_intro.html">
      〈 <span class="u-margin-right-tiny"></span> Introduction to Digital Systems
    </a>
  

  
    

    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/eglm03-textbook/06/3/cse.html">
      Continuous Systems Equivalence <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

              <footer>
  <p class="footer">This page was created by <a href="https://www.swansea.ac.uk/staff/engineering/c.p.jobling/">Dr Chris Jobling</a> for <a href="https://www.swansea.ac.uk">Swansea University</a>.</p>
</footer>

            </div>

        </div>
      </main>
    </div>
  </body>
</html>
