---
interact_link: content/04/1/zeigler.ipynb
kernel_name: matlab
kernel_path: content/04/1
has_widgets: false
title: |-
  Zeigler-Nichols Tuning Algorithms
pagenum: 16
prev_page:
  url: /04/0/intro.html
next_page:
  url: /04/2/tuning.html
suffix: .ipynb
search: response s loop tuning system pid zeigler step method parameters k closed ultimate nichols equation open control gain sub process type order l table sensitivity root locus ku systems figure tangent t frac begin end poles matlab methods any determine apparent axis mathrm works operation ksubu tsubu transfer let us compensator array algorithms only need responses found applications work overdamped damped shown typical slope given tuned according prop ti td p pi stable constant settling final value thus take indicated well le under however auto crosses point becomes oscillation period frequency kp g h again function range construct examine superimposed

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Zeigler-Nichols Tuning Algorithms</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Lecturer</strong></p>
<p>Set up MATLAB</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">cd </span><span class="s">matlab</span><span class="p"></span>
<span class="n">pwd</span>
<span class="s">clear all</span><span class="p"></span>
<span class="n">format </span><span class="s">compact</span><span class="p"></span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
ans =

    &#39;/Users/eechris/dev/eglm03-textbook/content/04/1/matlab&#39;

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Zeigler-Nichols-Tuning-Algorithms">Zeigler-Nichols Tuning Algorithms<a class="anchor-link" href="#Zeigler-Nichols-Tuning-Algorithms"> </a></h1><p>Based on empirical observations of PID tuning strategies for process control, Zeigler and Nichols have proposed two methods of choosing the first-pass settings for PID compensators. The methods only need measured system responses and are generally applicable to type 0 systems of any order that are commonly found in process control applications (i.e. control of level, temperature, pressure, flow, etc.).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Step-Response-Method">Step Response Method<a class="anchor-link" href="#Step-Response-Method"> </a></h2><p>Zeigler-Nichols' step response method will work on any system that has an 
open-loop step response that is an essentially critically or overdamped damped 
character like that shown in Figure 1.</p>
<p><img src="images/fig1.png" alt="Open-loop step response for a typical process control system">
<strong>Figure 1: Open-loop step response for a typical process control system</strong></p>
<p>From this response it is necessary to determine only two parameters.</p>
<ul>
<li>The slope $R$ of the tangent to the steepest part of the rising edge. </li>
<li>The "apparent dead-time" $L$ (which is the intersection of the tangent with the time axis).</li>
</ul>
<p>Given that $a = RL$, the PID parameters are then tuned according to Table 1.</p>
<p><strong>Table 1 Tuning parameters for Zeigler-Nichols' time response method</strong></p>
<table>
<thead><tr>
<th>Type</th>
<th>$K_{\mathrm{prop}}$</th>
<th>$T_I$</th>
<th>$T_D$</th>
</tr>
</thead>
<tbody>
<tr>
<td>P</td>
<td>1/<em>a</em></td>
</tr>
<tr>
<td>PI</td>
<td>0.9/<em>a</em></td>
<td>3<em>L</em></td>
<td></td>
</tr>
<tr>
<td>PID</td>
<td>1.2/<em>a</em></td>
<td>2<em>L</em></td>
<td>0.5<em>L</em></td>
</tr>
</tbody>
</table>
<p>Provided that the open-loop response is stable, it is possible to measure the apparent time constant $T$. For a second order system it can be shown that the settling time (to 98% of the final value) of an overdamped system is approximately $4T$. We thus take this as an approximation for any higher-order system that has the general shape indicated in Figure 1. Thus</p>
$$T\approx \frac{T_s }{4}.$$
<pre><code>                                  

</code></pre>
<p>Given the apparent time constant, Zeigler-Nichols' step response tuning 
method works reasonably well for</p>
$$0.15\le \frac{L}{T}\le 0.6.$$
<pre><code>                            .

</code></pre>
<p>Under these conditions, the choice of tuning parameters indicated in Table 1 would give a closed-loop system with good load-disturbance rejection properties. Zeigler-Nichols tuning methods, however, tend to produce systems whose transient response is rather oscillatory and so will need to be tuned further prior to putting the system into closed-loop operation.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Ultimate-sensitivity-method">Ultimate sensitivity method<a class="anchor-link" href="#Ultimate-sensitivity-method"> </a></h2><p>This tuning algorithm works for type 0 systems that have order &gt; 2. It can also be adapted to work in auto-tuning implementations of PID compensators<sup>2</sup>. The tuning method relies on being able to find the gain at which the Nyquist response crosses the critical point or equivalently when the root locus crosses the imaginary axis. It can be found experimentally, but requires that the gain be increased in closed-loop operation until the response becomes a sustained oscillation. This may be a dangerous mode of operation in some process control applications! The gain at which the system becomes marginally stable is called $K_u$. The period of oscillation of this frequency is $T_u$.</p>
<p>Once these two parameters are known, the PID parameters are selected according to Table 2.</p>
<p><strong>Table 2 Tuning parameters for Zeigler-Nichols' ultimate sensitivity method</strong></p>
<table>
<thead><tr>
<th>Type</th>
<th>$$K_{\mathrm{prop}}$$</th>
<th>$$T_I$$</th>
<th>$$T_D$$</th>
</tr>
</thead>
<tbody>
<tr>
<td>P</td>
<td>0.5 <em>K<sub>u</sub></em></td>
</tr>
<tr>
<td>PI</td>
<td>0.45 <em>K<sub>u</sub></em></td>
<td><em>T<sub>u</sub></em>/1.2</td>
<td></td>
</tr>
<tr>
<td>PID</td>
<td>0.6 <em>K<sub>u</sub></em></td>
<td><em>T<sub>u</sub></em></td>
<td><em>T</em><sub>u</sub>/8</td>
</tr>
</tbody>
</table>
<p>The static gain for the open-loop system is</p>
$$K_p=\left.G(s)H(s)\right|_{s=0}$$
<pre><code>        

</code></pre>
<p>The ultimate sensitivity tuning method works well if:</p>
$$2&lt;K_p\,K_u&lt;20$$<p></p>
<p>but again, the closed-loop response tends to be somewhat under-damped.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h2><p>To illustrate the application of the Zeigler-Nichols tuning rules we take 
the plant:</p>
$$\begin{equation}G(s)=\frac{6}{(s+1)(s+2)(s+3)}\end{equation}$$
<pre><code>                      .                                 </code></pre>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">G</span> <span class="p">=</span> <span class="n">zpk</span><span class="p">([],[</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span><span class="mi">6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
G =
 
          6
  -----------------
  (s+1) (s+2) (s+3)
 
Continuous-time zero/pole/gain model.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The feedback:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">H</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Loop transfer function:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">GH</span><span class="p">=</span><span class="n">G</span><span class="o">*</span><span class="n">H</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Time-response-method">Time response method<a class="anchor-link" href="#Time-response-method"> </a></h3><p>The open-loop step response of the system is</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">step</span><span class="p">(</span><span class="n">GH</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/04/1/zeigler_12_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From this figure, we determine that settling time:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Ts</span> <span class="p">=</span> <span class="mf">4.95</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>so</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">T</span> <span class="p">=</span> <span class="n">Ts</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The tangent seems to cross the time axis at</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">cmin</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">tmin</span> <span class="p">=</span> <span class="mf">0.42</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>and the final value at</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">cmax</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">tmax</span> <span class="p">=</span> <span class="mf">2.674</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us add this information to the step response:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="p">[</span><span class="n">c</span><span class="p">,</span><span class="n">t</span><span class="p">]=</span><span class="n">step</span><span class="p">(</span><span class="n">GH</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
<span class="n">plot</span><span class="p">([</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">],[</span><span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span><span class="p">],</span><span class="s">&#39;r-&#39;</span><span class="p">),</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">hold</span> <span class="n">on</span><span class="p">,</span><span class="c">...</span>
<span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mf">0.98</span><span class="p">,</span><span class="mf">0.98</span><span class="p">],</span><span class="s">&#39;g--&#39;</span><span class="p">,[</span><span class="n">Ts</span><span class="p">,</span><span class="n">Ts</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.98</span><span class="p">],</span><span class="s">&#39;g--&#39;</span><span class="p">,[</span><span class="n">Ts</span><span class="p">],[</span><span class="mf">0.98</span><span class="p">],</span><span class="s">&#39;b*&#39;</span><span class="p">),</span><span class="c">...</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Zeigler-Nichols Step Response Method&#39;</span><span class="p">),</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">c</span><span class="p">),</span><span class="n">hold</span> <span class="n">off</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/04/1/zeigler_22_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The slope of the tangent is</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">R</span> <span class="p">=</span> <span class="p">(</span><span class="n">cmax</span><span class="o">-</span><span class="n">cmin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">tmax</span><span class="o">-</span><span class="n">tmin</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>R =
    0.4437
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The parameter</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">L</span> <span class="p">=</span> <span class="n">tmin</span><span class="p">;</span>
<span class="n">L</span><span class="o">/</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ans =
    0.3394
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>is in the rquired range so</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">a</span><span class="p">=</span><span class="n">R</span><span class="o">*</span><span class="n">L</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>and the PID parameters are</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Kprop</span> <span class="p">=</span> <span class="mf">1.2</span><span class="o">/</span><span class="n">a</span><span class="p">;</span> <span class="n">Ti</span> <span class="p">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="p">;</span> <span class="n">Td</span> <span class="p">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">L</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>we construct the PID compensator</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Prop</span> <span class="p">=</span> <span class="n">tf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">Integ</span> <span class="p">=</span> <span class="n">tf</span><span class="p">(</span><span class="mi">1</span><span class="p">,[</span><span class="n">Ti</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">Deriv</span> <span class="p">=</span> <span class="n">tf</span><span class="p">([</span><span class="n">Td</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span>
<span class="n">PID1</span> <span class="p">=</span> <span class="n">Kprop</span><span class="o">*</span><span class="p">(</span><span class="n">Prop</span> <span class="o">+</span> <span class="n">Integ</span> <span class="o">+</span> <span class="n">Deriv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
PID1 =
 
  1.136 s^2 + 5.41 s + 6.44
  -------------------------
           0.84 s
 
Continuous-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">PID1z</span> <span class="p">=</span> <span class="n">zpk</span><span class="p">(</span><span class="n">PID1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
PID1z =
 
  1.3524 (s+2.381)^2
  ------------------
          s
 
Continuous-time zero/pole/gain model.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us examine the root-locus. The closed-loop poles are:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Gc1</span> <span class="p">=</span> <span class="n">feedback</span><span class="p">(</span><span class="n">PID1</span><span class="o">*</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">);</span>
<span class="p">[</span><span class="n">poles</span><span class="p">,</span><span class="nb">zeros</span><span class="p">,</span><span class="n">gain</span><span class="p">]=</span><span class="n">zpkdata</span><span class="p">(</span><span class="n">Gc1</span><span class="p">,</span><span class="s">&#39;v&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So the root-locus (with closed-loop poles superimposed)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">rlocus</span><span class="p">(</span><span class="n">PID1</span><span class="o">*</span><span class="n">GH</span><span class="p">),</span><span class="n">hold</span> <span class="n">on</span><span class="p">,</span><span class="n">plot</span><span class="p">(</span><span class="n">poles</span><span class="p">,</span><span class="s">&#39;*&#39;</span><span class="p">),</span><span class="c">...</span>
    <span class="n">title</span><span class="p">(</span><span class="s">&#39;Zeigler Nichols: Root Locus for Step Response Method&#39;</span><span class="p">),</span><span class="n">hold</span> <span class="n">off</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/04/1/zeigler_37_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>and the step response</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">step</span><span class="p">(</span><span class="n">Gc1</span><span class="p">),</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Zeigler Nichols: Step Response for Step Response Method&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/04/1/zeigler_39_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Ultimate-sensitivity-method">Ultimate sensitivity method<a class="anchor-link" href="#Ultimate-sensitivity-method"> </a></h3><p>The open-loop transfer response of the system is $KG(s)H(s)$. We use the Routh-Hurwitz 
criterion for determine the "ultimate" gain <em>Ku</em>.</p>
<p>The closed-loop transfer function is:</p>
$$\begin{equation}G_c(s)=\frac{6K}{s^3+6s^2+11s+6(1+K)}.\end{equation}$$
<pre><code> .                            

</code></pre>
<p>So the closed-loop characteristic equation is:</p>
$$\begin{equation}s^3+6s^2+11s+6(1+K)=0.\end{equation}$$<p>The routh array is</p>
$$\begin{array}{*{20}{c}}  
\mathrm{Order}&amp;| &amp; {}&amp;{} \\
\hline  
s^3 &amp;| &amp; 1&amp;{11} \\   
s^2 &amp;| &amp; 6&amp;{6(1 + K)} \\
s^1 &amp;| &amp; {10 - K}&amp;{} \\
s^0 &amp;| &amp; {6(1 + K)}&amp;{} 
\end{array}$$<p>So the ultimate gain  $K_u=10$.</p>
<p>When $K = K_u$ the $s_1$ row is zero and the previous row represents a 
factor of the characteristic equation. Hence</p>
$$ 6{s^2} + 6(1 + K) = 0 \\
6{s^2} + 66 = 0 \\
{s^2} =  - 11 \\
s =  \pm j\sqrt {11}$$
<pre><code>                         

</code></pre>
<p>The ultimate frequency and ultimate period:</p>
$$\omega_u=\sqrt{11}$$
<pre><code>                                   </code></pre>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Ku</span> <span class="p">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">Tu</span> <span class="p">=</span> <span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To check the validity of this design:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Kp</span> <span class="p">=</span> <span class="n">dcgain</span><span class="p">(</span><span class="n">GH</span><span class="p">)</span>
<span class="n">Kp</span><span class="o">*</span><span class="n">Ku</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Kp =
     1
ans =
    10
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>... which is in the suggested range.</p>
<p>The PID parameters are</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Kprop</span> <span class="p">=</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">Ku</span><span class="p">;</span> <span class="n">Ti</span> <span class="p">=</span> <span class="n">Tu</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="n">Td</span> <span class="p">=</span> <span class="n">Tu</span><span class="o">/</span><span class="mi">8</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We again construct the PID compensator</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Prop</span> <span class="p">=</span> <span class="n">tf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">Integ</span> <span class="p">=</span> <span class="n">tf</span><span class="p">(</span><span class="mi">1</span><span class="p">,[</span><span class="n">Ti</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">Deriv</span> <span class="p">=</span> <span class="n">tf</span><span class="p">([</span><span class="n">Td</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span>
<span class="n">PID2</span> <span class="p">=</span> <span class="n">Kprop</span><span class="o">*</span><span class="p">(</span><span class="n">Prop</span> <span class="o">+</span> <span class="n">Integ</span> <span class="o">+</span> <span class="n">Deriv</span><span class="p">)</span>  
<span class="n">PID2z</span> <span class="p">=</span> <span class="n">zpk</span><span class="p">(</span><span class="n">PID2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
PID2 =
 
  1.346 s^2 + 5.683 s + 6
  -----------------------
         0.9472 s
 
Continuous-time transfer function.


PID2z =
 
  1.4208 (s+2.111)^2
  ------------------
          s
 
Continuous-time zero/pole/gain model.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us examine the root-locus. The closed-loop poles are:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Gc2</span> <span class="p">=</span> <span class="n">feedback</span><span class="p">(</span><span class="n">PID2</span><span class="o">*</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">);</span>
<span class="p">[</span><span class="n">poles</span><span class="p">,</span><span class="nb">zeros</span><span class="p">,</span><span class="n">gain</span><span class="p">]=</span><span class="n">zpkdata</span><span class="p">(</span><span class="n">Gc2</span><span class="p">,</span><span class="s">&#39;v&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So the root-locus (with closed-loop poles superimposed)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">rlocus</span><span class="p">(</span><span class="n">PID2</span><span class="o">*</span><span class="n">GH</span><span class="p">),</span><span class="n">hold</span> <span class="n">on</span><span class="p">,</span><span class="c">...</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">poles</span><span class="p">,</span><span class="s">&#39;*&#39;</span><span class="p">),</span><span class="c">...</span>
    <span class="n">title</span><span class="p">(</span><span class="s">&#39;Zeigler Nichols: Root Locus for Ultimate Sensitivity Method&#39;</span><span class="p">),</span><span class="n">hold</span> <span class="n">off</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/04/1/zeigler_51_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>and the step response</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">step</span><span class="p">(</span><span class="n">Gc2</span><span class="p">),</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Zeigler Nichols: Step Response for Ultimate Sensitivity Method&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/04/1/zeigler_53_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Discussion">Discussion<a class="anchor-link" href="#Discussion"> </a></h2><p>Comparison of the two designs:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="p">[</span><span class="n">y1</span><span class="p">,</span><span class="n">t1</span><span class="p">]=</span><span class="n">step</span><span class="p">(</span><span class="n">Gc1</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
<span class="p">[</span><span class="n">y2</span><span class="p">,</span><span class="n">t2</span><span class="p">]=</span><span class="n">step</span><span class="p">(</span><span class="n">Gc2</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">t2</span><span class="p">,</span><span class="n">y2</span><span class="p">),</span><span class="n">legend</span><span class="p">(</span><span class="s">&#39;Step response&#39;</span><span class="p">,</span><span class="s">&#39;Ultimate sens.&#39;</span><span class="p">),</span><span class="c">...</span>
    <span class="n">title</span><span class="p">(</span><span class="s">&#39;Comparison of results&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/04/1/zeigler_55_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There is actually very little difference in these two responses. We might choose the result of the ultimate sensitivity as it has a slightly lower peak overshoot. However, it is likely that we can do much better by taking these results as a staring point.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Footnotes">Footnotes<a class="anchor-link" href="#Footnotes"> </a></h2><p>[1] Integral action is hardly ever added to systems of type 1 or greater. The additional pole at the origin is usually extremely destabilising.</p>
<p>[2] An auto-tuner is a PID compensator that can choose its own parameters. It is naturally a digital device and consists of a microcontroller with some built-in tuning algorithms. Such devices are available commercially.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Resources">Resources<a class="anchor-link" href="#Resources"> </a></h2><p>An executable version of this document is available to download as a MATLAB Live Script file <a href="matlab/zeigler.mlx">zeigler.mlx</a>.</p>

</div>
</div>
</div>
</div>

 


    </main>
    