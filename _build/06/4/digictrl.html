---
interact_link: content/06/4/digictrl.ipynb
kernel_name: matlab
kernel_path: content/06/4
has_widgets: false
title: |-
  Introduction to Digital Control
pagenum: 27
prev_page:
  url: /06/3/cse.html
next_page:
  url: /07/index.html
suffix: .ipynb
search: z s e frac d design g n u root locus t equivalent hold aligned left digital zero right system frequency zoh plant sqrt continuous st compensator end sampling function k pictures png begin plane example times matlab transfer kd between discretization mapping omegas omegan methods order mathcal tustin gain alpha control equation since stability unit circle because comparison pole rates discrete used section using need method matched poles let loop lag architecture below boundary j natural damping response closed where dg kp kc gamma pm followed direct cse omega test constant also designed approach given different cd map documentation

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Introduction to Digital Control</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Introduction-to-Digital-Control">Introduction to Digital Control<a class="anchor-link" href="#Introduction-to-Digital-Control"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Purpose-of-this-Section">Purpose of this Section<a class="anchor-link" href="#Purpose-of-this-Section"> </a></h2><p>To describe the basic tools for the design of a control system to be
implemented using a computer or microcomputer.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Contents</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Typical architecture</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Relationship between $s$ and $z$</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Continuous design followed by Discretization</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Direct digital design</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Typical-Architecture-of-a-Digital-Control-System">Typical Architecture of a Digital Control System<a class="anchor-link" href="#Typical-Architecture-of-a-Digital-Control-System"> </a></h2><p><img src="pictures/digicon.png" alt="Digital control system"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Relationship-between-$s$-and-$z$">Relationship between $s$ and $z$<a class="anchor-link" href="#Relationship-between-$s$-and-$z$"> </a></h2><p>We have already seen that (see <a href="../3/cse">Section 6.3</a>)</p>
$$\begin{equation}z=e^{sT}\end{equation}$$<p></p>
<p>and</p>
$$\begin{equation}
    s=\frac{1}{T}\ln z
\end{equation}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can use Equation¬†(1) to define a mapping between the $s$ and $z$ planes as summarised below.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Mapping-between-between-s-and-z">Mapping between between s and z<a class="anchor-link" href="#Mapping-between-between-s-and-z"> </a></h3><p>Since $z=e^{sT}$ we can define a 'mapping' from the $s$-plane to the $z$-plane. Various properties of the $z$-plane follow.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>s-plane stability boundary $s=j\omega$ maps to the unit circle in the z-plane:</li>
</ul>
$$|z|=1$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Maximum frequency is half the sampling frequency $\omega_s/2$ (a consequence of Nyquist's sampling theorem) and is mapped to the negative real axis in the z-plane.</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For proofs, see the problems in the self-directed learning exercises.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Stability-in-the-z-plane">Stability in the z-plane<a class="anchor-link" href="#Stability-in-the-z-plane"> </a></h3><ul>
<li>Because the stability boundary is a unit circle, Routh-Hurwitz and
Nyquist stability tests no longer work.</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>The Jury test is a similar test to the Routh-Hurwitz test but it is
more involved.</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>The design curves for constant natural frequency $\omega_n$, damping
ratio $\zeta$, $\sigma_d$ and $\omega_d$ are also distorted by the
mapping.</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="z-plane-Design-Curves">z-plane Design Curves<a class="anchor-link" href="#z-plane-Design-Curves"> </a></h3><p>Use the Matlab function <code>zgrid</code> to see the mapping.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">zgrid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/06/4/digictrl_18_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Continuous-Design">Continuous Design<a class="anchor-link" href="#Continuous-Design"> </a></h2><p>Assumption -- we have designed a compensator using root-locus or frequency response and now need to implement it with digital hardware, e.g. a digital micro-controller or digital signal processor (DSP).</p>
<p>We will recall the <strong>discretization</strong> methods discussed in the <a href="../3/cse">last section</a>, give a comparison of their frequency response behaviour and the applicability of the continuous design approach. We conclude with an example.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Discretization-Procedure">Discretization Procedure<a class="anchor-link" href="#Discretization-Procedure"> </a></h3><p><img src="pictures/digitization.png" alt="Digitization"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The idea is that given a continuous compensator transfer function $D(s)$ we need to find the best equivalent $D(z)$. As illustrated in , there is no exact solution since the whole time history is available to $D(s)$ whereas only  samples are available to $D(z)$ so different discretization approximation methods make different assumptions about what happens to $e(t)$ between sampling instants.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Discretization-with-MATLAB">Discretization with MATLAB<a class="anchor-link" href="#Discretization-with-MATLAB"> </a></h3><p>Given a continuous $D(s)$ find best equivalent $D(z)$.</p>
<p>Take a transfer function (here $D(s)=p/(s+p)$) and return an equivalent
$D(z)$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">p</span> <span class="p">=</span> <span class="mi">5</span><span class="p">;</span> <span class="c">% rad/s</span>
<span class="n">ds</span> <span class="p">=</span> <span class="n">tf</span><span class="p">([</span><span class="n">p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span> <span class="n">p</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
ds =
 
    5
  -----
  s + 5
 
Continuous-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Fs</span> <span class="p">=</span> <span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">);</span> <span class="c">% Hz</span>
<span class="n">Ts</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To discretize $D(s)$ we use</p>
<div class="highlight"><pre><span></span><span class="n">dz</span> <span class="p">=</span> <span class="n">c2d</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">Ts</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Summary-of-Discretization-Methods">Summary of Discretization Methods<a class="anchor-link" href="#Summary-of-Discretization-Methods"> </a></h3><table>
<thead><tr>
<th><strong>Method</strong></th>
<th><strong>Transform</strong></th>
<th><strong>c2d method</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Zero-order hold</td>
<td>$$(1-z^{-1})\mathcal{Z}(D(s)/s)$$</td>
<td><code>'zoh'</code></td>
</tr>
<tr>
<td>Tustin (bilinear transform)</td>
<td>$$s = (2/T)(1-z^{-1})/(1+z^{-1})$$</td>
<td><code>'tustin'</code></td>
</tr>
<tr>
<td>Matched pole-zero</td>
<td>map poles/zeros using $z=e^{sT}$</td>
<td><code>'matched'</code></td>
</tr>
<tr>
<td>First-order hold</td>
<td>See Matlab documentation</td>
<td><code>'foh'</code></td>
</tr>
<tr>
<td>Impulse-invariant</td>
<td>See Matlab documentation</td>
<td><code>'imp'</code></td>
</tr>
<tr>
<td>Tustin with pre-warp</td>
<td>See Matlab documentation</td>
<td><code>'prewarp'</code></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For example, for <em>Zero-Order-Hold Equivalent</em></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">dz</span> <span class="p">=</span> <span class="n">c2d</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">Ts</span><span class="p">,</span> <span class="s">&#39;zoh&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
dz =
 
    0.2696
  ----------
  z - 0.7304
 
Sample time: 0.062832 seconds
Discrete-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">step</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="s">&#39;-&#39;</span><span class="p">,</span><span class="n">dz</span><span class="p">,</span><span class="s">&#39;--&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/06/4/digictrl_29_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>See <a href="../3/cse">Section 6.3</a> for mathematical derivations.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Comparison-of-approximations">Comparison of approximations<a class="anchor-link" href="#Comparison-of-approximations"> </a></h3><p>You can run this example yourself by downloading and executing the script <a href="matlab/comparison">comparison.m</a>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Compare-digital-equivalents">Compare digital equivalents<a class="anchor-link" href="#Compare-digital-equivalents"> </a></h4><p>First plot continuous frequency response.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">ds</span> <span class="p">=</span> <span class="n">tf</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">bode</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<span class="n">grid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
ds =
 
    5
  -----
  s + 5
 
Continuous-time transfer function.

</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/06/4/digictrl_33_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Run comparison for $f_s = 15$ Hz.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Fs</span> <span class="p">=</span> <span class="mi">15</span><span class="p">;</span>
<span class="n">Ts</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Hold-equivalent">Hold equivalent<a class="anchor-link" href="#Hold-equivalent"> </a></h5>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">dsz</span><span class="p">=</span><span class="n">c2d</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">Ts</span><span class="p">,</span> <span class="s">&#39;zoh&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
dsz =
 
    0.2835
  ----------
  z - 0.7165
 
Sample time: 0.066667 seconds
Discrete-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Tustin-equivalent">Tustin equivalent<a class="anchor-link" href="#Tustin-equivalent"> </a></h5>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">dst</span> <span class="p">=</span> <span class="n">c2d</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">Ts</span><span class="p">,</span> <span class="s">&#39;tustin&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
dst =
 
  0.1429 z + 0.1429
  -----------------
     z - 0.7143
 
Sample time: 0.066667 seconds
Discrete-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Matched-pole-zero">Matched pole-zero<a class="anchor-link" href="#Matched-pole-zero"> </a></h5>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">dsm</span> <span class="p">=</span> <span class="n">c2d</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">Ts</span><span class="p">,</span> <span class="s">&#39;mpz&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
dsm =
 
    0.2835
  ----------
  z - 0.7165
 
Sample time: 0.066667 seconds
Discrete-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Make-Bode-plot">Make Bode plot<a class="anchor-link" href="#Make-Bode-plot"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">bode</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="n">dsz</span><span class="p">,</span><span class="s">&#39;*&#39;</span><span class="p">,</span><span class="n">dst</span><span class="p">,</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">dsm</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="n">grid</span>
<span class="s">legend(&#39;D(jw)&#39;,&#39;ZOH&#39;,&#39;Tustin&#39;,&#39;MPZ&#39;)</span><span class="p"></span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Magnitude and phase of discrete equivalents for D(s) = 5/(s+5) - Fs = 15 Hz&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/06/4/digictrl_43_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Repeat comparison for  $f_ùë†=5$ Hz.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Fs</span> <span class="p">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">Ts</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Hold-equivalent">Hold equivalent<a class="anchor-link" href="#Hold-equivalent"> </a></h5>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">dsz</span><span class="p">=</span><span class="n">c2d</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">Ts</span><span class="p">,</span> <span class="s">&#39;zoh&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
dsz =
 
    0.6321
  ----------
  z - 0.3679
 
Sample time: 0.2 seconds
Discrete-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Tustin-equivalent">Tustin equivalent<a class="anchor-link" href="#Tustin-equivalent"> </a></h5>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">dst</span> <span class="p">=</span> <span class="n">c2d</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">Ts</span><span class="p">,</span> <span class="s">&#39;tustin&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
dst =
 
  0.3333 z + 0.3333
  -----------------
     z - 0.3333
 
Sample time: 0.2 seconds
Discrete-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Matched-pole-zero">Matched pole-zero<a class="anchor-link" href="#Matched-pole-zero"> </a></h5>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">dsm</span> <span class="p">=</span> <span class="n">c2d</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">Ts</span><span class="p">,</span> <span class="s">&#39;mpz&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
dsm =
 
    0.6321
  ----------
  z - 0.3679
 
Sample time: 0.2 seconds
Discrete-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Make-Bode-plot">Make Bode plot<a class="anchor-link" href="#Make-Bode-plot"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">bode</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="n">dsz</span><span class="p">,</span><span class="s">&#39;*&#39;</span><span class="p">,</span><span class="n">dst</span><span class="p">,</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">dsm</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="n">grid</span>
<span class="s">legend(&#39;D(jw)&#39;,&#39;ZOH&#39;,&#39;Tustin&#39;,&#39;MPZ&#39;)</span><span class="p"></span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Magnitude and phase of discrete equivalents for D(s) = 5/(s+5) - Fs = 5 Hz&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/06/4/digictrl_53_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You should note that the approximations are good for frequencies below about $\omega_s/4$. If $\omega_s$ is sufficiently high, then break frequencies are accurately reproduced. MPZ and Tustin show a notch at $\omega_s/2$
because of the zero term at $1+z^{-1}$. Apart from the large difference at $\omega_s/2$, which is typically outside the working frequency, all methods have similar performance. Since MPZ is easier to calculate by hand, it is often to be preferred. However, if you have access to MATLAB and the control system toolbox function <em>c2d</em>, there is no need to use anything other than ZOH (which is the default) or the Tustin method.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Design-Example">Design Example<a class="anchor-link" href="#Design-Example"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Plan-for-classroom-session">Plan for classroom session<a class="anchor-link" href="#Plan-for-classroom-session"> </a></h4><p>In the session we will:</p>
<ul>
<li>design a continous compensator for a plant and discretize it by MPZ method</li>
<li>see how the digital compensator would be implemented</li>
<li>discuss the limitations of "continuous design"</li>
<li>redesign the compensator using a digital-design approach.</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us consider the lead compensation of the double integrator system
shown below.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Design-Example">Design Example<a class="anchor-link" href="#Design-Example"> </a></h4><p><img src="pictures/ex1-1.png" alt="Figure 1"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us further assume that we want to have the dominant closed-loop poles with ideal damping $\zeta=1/\sqrt{2}$ and natural frequency $\omega_n = 2\sqrt{2}$ rad/s. Furthermore, let us assume that the zero will be placed at $s=-1$ so that the compensator $D(s) = K(s+1)/(s+p)$.</p>
<p>The root-locus design parameters will then be obtained from the pole-zero map shown below.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Root-Locus-Design-Parameters">Root Locus Design Parameters<a class="anchor-link" href="#Root-Locus-Design-Parameters"> </a></h4><p><img src="pictures/ex1-2.png" alt="Figure 2"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\theta_z = \tan^{-1} 2/1 = 116.57^\circ$$$$\begin{aligned}
    -\theta_p + 116.57 -270 = &amp; -180 \\
    -\theta_p = &amp; -180 - 153.43 \\
    \theta_p = &amp; 26.57^\circ\end{aligned}$$$$\begin{aligned}
    -\tan 26.57 = &amp; \frac{2}{x} \\
    x  = &amp; 2/\tan 26.57 = 4 \\
    p = &amp; -6\end{aligned}$$<p>To calculate the gain, we need to know that $l_1=2\sqrt{2}$, $l_2=\sqrt{5}$, $l_3=\sqrt{20}$.</p>
$$K = \frac{(2\sqrt{2})^2\times \sqrt{20}}{\sqrt{5}} = \frac{8\times 2\sqrt{5}}{\sqrt{5}} = 16.$$$$D(s) = \frac{16(s+1)}{(s+6)}.$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To convert to $D(z)$ let the sampling frequency $\omega_s=20\times \omega_n = 40\sqrt{2}=56.67$ rad/s. Thus
$f_s=\omega_s/2\pi = 9$¬†Hz so sampling period $T = 1/f_s \approx 0.1$¬†s.</p>
<p>Let's pretend that we are solving this problem in a context where we only have a calculator so we'll use matched-pole zero.</p>
$$D(z)=k\frac{1-e^{-aT}z^{-1}}{1-e^{-bT}z^{-1}}$$<p>where $k$ is determined by matching the DC gain of the two compensators. For the continuous compensator</p>
$$\left.$D(s)\right|_{s=0} = 16/6.$$<p></p>
<p>For the digital compensator</p>
$$D(z)|_{z=1} = k(1-e^{-aT})/(1-e^{-bT}),$$<p>so</p>
$$k=\frac{16}{6}\times\frac{1-e^{-bT}}{1-e^{-aT}}$$<p>For our design, $T=0.1$, $a=1$ and $b=6$ so $$\begin{aligned}
    k = &amp; \frac{16}{6}\times\frac{1-e^{-0.6}}{1-e^{-0.1}} \\
    = &amp; \frac{16}{6}\times\frac{1-0.5488}{1-0.9048} = \frac{16}{6}\times\frac{0.4512}{0.0952}  \\
    k  = &amp; 12.64\end{aligned}$$</p>
<p>So $$D(z) = \frac{12.64(1-0.9048z^{-1})}{(1-0.5488z^{-1})}.$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Implementation-of-design">Implementation of design<a class="anchor-link" href="#Implementation-of-design"> </a></h4><p>Since</p>
<p>$D(z)=U(z)/E(z)$ then</p>
$$\begin{aligned}
    (1-0.5488z^{-1})U(z) = &amp; 12.64(1-0.9048z^{-1})E(z) \\
    U(z) - 0.5488z^{-1}U(z) = &amp; 12.64 E(z) - 11.44 z^{-1} E(z) \\
    U(z) = &amp; 0.5488z^{-1}U(z) + 12.64 E(z) - 11.44 z^{-1} E(z)\end{aligned}$$<p>Converting this into (sampled) time domain</p>
$$u(n) = 0.5488 u(n-1) + 12.64 e(n) - 11.44 e(n-1)$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Implementation-of-design---pseudocode">Implementation of design - pseudocode<a class="anchor-link" href="#Implementation-of-design---pseudocode"> </a></h4><p>We could implement this in pseudo code:</p>

<pre><code>while (true) do
  /* read current error from ADC */
  e(n) = ADC
  /* calculate and output control action */
  u(n) = 0.5488 * u(n-1) + 12.64 * e(n) - 11.44 * e(n-1)
  /* Store past values */
  e(n-1) = e(n)
  u(n-1) = u(n)
  wait for next sample time
end while</code></pre>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Limits-of-Continuous-Design-Approach">Limits of Continuous Design Approach<a class="anchor-link" href="#Limits-of-Continuous-Design-Approach"> </a></h3><ul>
<li><p>Limitations on sampling rate</p>
</li>
<li><p>Lag effect of ZOH at low-sampling rates</p>
</li>
</ul>
<p>See notes for more detail.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If an exact discrete analysis or a simulation of a system were performed and discretization determined for a large range of sampling rates the digitised system would be unstable for rates slower than approximately $5\omega_n$ (where $\omega_n$ is the natural frequency of the system dominant poles) and damping would be degraded for rates slower than $10\omega_n$. At sampling rates higher than $20\omega_n$ (or $20\times \omega_{BW}$ for more complex systems) then all methods yield reasonable results and can be used with confidence at rates of $30\times \omega_{BW}$ or higher.</p>
<p>Errors come about because the approximations ignore the phase lag effect of the zero-order-hold (ZOH). The ZOH can be approximated by</p>
$$G_{zoh}(s)\approx \frac{2/T}{s+(2/T)}$$<p>which is based on the idea that, on average, the ZOH delays the signal by about $T/2$ seconds and this transfer function is a first-order lag with time constant $T/2$ and DC gain of 1. If this was added to the plant transfer function then a more accurate model of the delayed plant wiould be obtained and a more stable design for $D(s)$.</p>
<p>However, the advantage of continuous design is that $T$ is not chosen until after $D(s)$ is designed and the appearance of $T$ so early invalidates this assumption.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Direct-Digital-Design">Direct Digital Design<a class="anchor-link" href="#Direct-Digital-Design"> </a></h2><ul>
<li><p>Used when limitations on sampling would be breached.</p>
</li>
<li><p>Stability boundary is unit circle which adds complications not
present for continous time systems</p>
</li>
<li><p>Additional complexity added because of distorting effect of the
mapping $z=e^{sT}$</p>
</li>
</ul>
<p>We will illustrate with an example.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Direct digital design may be used if the zero-order hold is to be taken into account or if the sample time is somehow constrained. The discrete transfer function for the plant, hold and compensator are used throughout and the root locus method<sup>1</sup> is used in the $z$-domain.</p>
<p>In this presentation, we will consider how the plant is digitized and how the compensator can be designed using the root locus technique in the $z$-domain.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Analysis-Tools">Analysis Tools<a class="anchor-link" href="#Analysis-Tools"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Assumed-architecture">Assumed architecture<a class="anchor-link" href="#Assumed-architecture"> </a></h4><p><img src="pictures/digisys.png" alt="assumed architecture"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Discrete-equivalent">Discrete equivalent<a class="anchor-link" href="#Discrete-equivalent"> </a></h4><p><img src="pictures/digequiv.png" alt="Discrete equivalent"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The zero-order hold (ZOH) precisely defines what happens to the continuous system between samples for there is a unique solution for the combination of the transfer functions of the ZOH and G(s). The transfer
function for ZOH (see <a href="../2/dsm">Section 6.2</a>) is $(1-e^{-sT})/s$ so for hold followed by plant we can use the mathematical development show in to determine $G(z)$. As we showed, the $1/s$ term is present because the output of ZOH is a piecewise constant function of time, and $1-z^{-1}$ represents a step followed by a negative step delayed by one sample period.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Hold-plus-plant">Hold plus plant<a class="anchor-link" href="#Hold-plus-plant"> </a></h5>$$\begin{aligned}
        \left(\frac{1-e^{-sT}}{s}\right)G(s) = &amp; (1-e^{-sT})\frac{G(s)}{s} \\
        \mathcal{Z}\left\{(1-e^{-sT})\frac{G(s)}{s}\right\} = &amp; \mathcal{Z}\{1-e^{-sT}\}\mathcal{Z}\left\{\frac{G(s)}{s}\right\} \\
        G(z) = &amp; (1-z^{-1}) \mathcal{Z}\left\{\frac{G(s)}{s}\right\}
    \end{aligned}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the discrete equivalent system</p>
$$\frac{C(z)}{D(z)} = \frac{DG(z)}{1+DG(z)}$$<p>and the closed-loop characteristic equation (CLCE) is</p>
$$1+DG(z)=0.$$<p>The root-locus plotting rules still apply but the interpretation is different.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example">Example<a class="anchor-link" href="#Example"> </a></h3>$$G(s)=\frac{a}{s+a}$$$$\begin{aligned}
    G(z) = &amp; (1-z^{-1})\mathcal{Z}\left\{\frac{a}{s(s+a)}\right\} \\
         = &amp; (1-z^{-1})\mathcal{Z}\left\{\frac{1}{s}-\frac{1}{s+a}\right\} \\
         = &amp; (1-z^{-1})\left\{\frac{z}{z-1}-\frac{z}{z+e^{-aT}}\right\} \\
         = &amp; \left(\frac{z-1}{z}\right)\left\{\frac{z(z-e^{-aT})-z(z-1)}{(z-1)(z+e^{-aT})}\right\} \\\end{aligned}$$$$G(z) = \frac{1-e^{-aT}}{z-e^{-aT}}.$$<p></p>
<p>So $G(z)=(1-\alpha)/(z-\alpha)$ where $\alpha=e^{-aT}$.</p>
<p>The implications of this result is assessed in the next two figures.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Root-locus-of-plant-$G(s)-=-a/(s-+-a)$">Root locus of plant $G(s) = a/(s + a)$<a class="anchor-link" href="#Root-locus-of-plant-$G(s)-=-a/(s-+-a)$"> </a></h4><p><img src="pictures/slocus.png" alt="Root locus of plant G(s) = a/(s + a)"></p>
<p>This is stable for all open-loop gain $K$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Root-locus-of-hold-equivalent-plant-$G(z)-=-(1-&#8722;-\alpha)/(z-+-\alpha)$">Root locus of hold-equivalent plant $G(z) = (1 &#8722; \alpha)/(z + \alpha)$<a class="anchor-link" href="#Root-locus-of-hold-equivalent-plant-$G(z)-=-(1-&#8722;-\alpha)/(z-+-\alpha)$"> </a></h4><p><img src="pictures/zlocus.png" alt="Root locus of hold-equivalent plant G(z) = (1 ‚àí \alpha)/(z + \alpha)"></p>
<p>This is unstable for some gain $K$ because of the time delay introduced
by ZOH.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Discrete-Three-Term-Compensators">Discrete Three Term Compensators<a class="anchor-link" href="#Discrete-Three-Term-Compensators"> </a></h4><table>
<thead><tr>
<th><strong>Type</strong></th>
<th><strong>Implementation</strong></th>
<th><strong>Transfer function</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Proportional</td>
<td>$$u(n) = K_Pe(n)$$</td>
<td>$$D(z)=K_P$$</td>
</tr>
<tr>
<td>Derivative</td>
<td>$$u(n) = K_D(e(n)-e(n-1)$$</td>
<td>$$D(z)=K_D(1-z^{-1})$$</td>
</tr>
<tr>
<td>Integral</td>
<td>$$u(n) = u(n-1) + K_Ie(n)$$</td>
<td>$$D(z)=K_I/(1-z^{-1})$$</td>
</tr>
</tbody>
</table>
<p>Of course, these can be combined to give P+D and PID. There are also
equivalents of lead, lag and lead-lag.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Design-example-repeated">Design example repeated<a class="anchor-link" href="#Design-example-repeated"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Example:-Double-integrator-plant-again">Example: Double-integrator plant again<a class="anchor-link" href="#Example:-Double-integrator-plant-again"> </a></h4>$$G(s)=\frac{1}{s^2}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Hold equivalent is</p>
$$G(z)=\frac{T^2}{2}\frac{(z+1)}{(z-1)^2}$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let $T = 0.1$ seconds then</p>
$$G(z)=\frac{1}{200}\frac{(z+1)}{(z-1)^2}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Root-locus">Root locus<a class="anchor-link" href="#Root-locus"> </a></h4><p><img src="pictures/zdi.png" alt="Root locus"></p>
<p>Note, root-locus is outside unit circle so system is unstable for all $K_P$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We introduce proportional plus derivative compensation to bring the root locus inside the unit circle. Thus, from the table</p>
$$U(z)=K_PE(z)+K_D(1-z^{-1})E(z)$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Hence</p>
$$\begin{aligned}
    D(z) = \frac{U(z)}{E(z)} = &amp; K_P + K_D - K_D z^{-1} \\
    = &amp; \frac{(K_P+K_D)z - K_D}{z} \\
    = &amp; (K_P+K_D)\left(\frac{z-(K_D/(K_P+K_D))}{z}\right) \\
    = &amp; K_c\left(\frac{z-\gamma}{z}\right)\end{aligned}$$<p></p>
<p>We note that
$$DG(z)=\frac{K_c}{200}\left(\frac{z-\gamma}{z}\right)\frac{(z+1)}{(z-1)^2}$$</p>
<p>and hence the root-locus gain $K_o=K_c/200$. The compensator adds a pole at $z=0$ and a zero at $z=\gamma$.</p>
<p>As before, we would like the system to have ideal damping and a natural frequency of $2\sqrt{2}$. But as we are now working in the $z$-plane, we also need to map the desired closed-loop poles by the mapping $s=e^{sT}$.</p>
<p>Since $s=-2\pm j2$ and $z=e^{sT}$ then $z=e^{-2T}e^{\pm j2T} = e^{-0.2}(\cos0.2\pm j\sin0.2) = 0.8024\pm j0.1627$.</p>
<p>Given this location for the desired closed-loop dominant poles, it is a matter of trigonometry to determine that $\gamma=0.8532$ and the root locus gain $K_o=0.0465$.</p>
<p>Now since $K_c=200 K_o = 9.31$ it is easy to show that $K_D=7.9367$ and $K_P=1.3703.$</p>
<p>The proof is left as an exercise.</p>
<h2 id="Footnotes">Footnotes<a class="anchor-link" href="#Footnotes"> </a></h2><p>1: Frequency response methods can be used, but are complicated by the fact that the stability boundary is the unit circle. We leave the methods, which are well covered in Franklin, Powell and Workman, as a topic for further research.</p>

</div>
</div>
</div>
</div>

 


    </main>
    