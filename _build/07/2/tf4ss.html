---
interact_link: content/07/2/tf4ss.ipynb
kernel_name: matlab
kernel_path: content/07/2
has_widgets: false
title: |-
  Laplace Transforms of State Space Models
pagenum: 30
prev_page:
  url: /07/1/intro2ss.html
next_page:
  url: /07/3/tr4ss.html
suffix: .ipynb
search: mathbf s array left right c begin end l lc r v t equation frac u transfer transform state matrix x bf system function eqnarray example b d vector y cc cdots sr space vdots laplace input equations output det models model zeros transforms responses corresponding mathcal epsilon gives zero th denominator tf poles polynomial convert into give vn transformed variables form obtained states section single resolvent numerator matlab roots class used differential lecture functions elements dt initial conditions therefore reduces element j relates important outputs define values step symbolic ssmodels mlx systems characteristic solutions whose detailed problems homework also

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Laplace Transforms of State Space Models</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Transforms-and-Time-Responses-for-State-Space-Models">Transforms and Time Responses for State Space Models<a class="anchor-link" href="#Transforms-and-Time-Responses-for-State-Space-Models"> </a></h1><ul>
<li>Laplace Transform of State Space Models</li>
<li>Time Responses for State Space Models</li>
<li>Detailed example (in class)</li>
<li>Problems (homework)</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Laplace-Transforms-of-State-Space-Models">Laplace Transforms of State Space Models<a class="anchor-link" href="#Laplace-Transforms-of-State-Space-Models"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Laplace transform can be used to convert a differential equation into a transfer function. It can also be used to convert a state space model into a transfer function. In this lecture we demonstrate how this is done and we give an example.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Laplace-transform-of-a-vector-of-functions">Laplace transform of a vector of functions<a class="anchor-link" href="#Laplace-transform-of-a-vector-of-functions"> </a></h3><p>The Laplace transform of a vector $\mathbf{v}(t)$ is a vector $\mathbf{V}(s)$. The elements of $\mathbf{V}(s)$ are the Laplace transforms of the corresponding elements of the vector $\mathbf{v}(t)$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For array</p>
$$\mathbf{v}(t) = \left[
  \begin{array}{c}
    v_1(t) \\
    v_2(t) \\
    \vdots \\
    v_n(t) \\
  \end{array}
  \right]$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The transformed variables are</p>
$$\mathcal{L}\mathbf{v}(t) = \left[
  \begin{array}{c}
   \mathcal{L} v_1(t) \\
   \mathcal{L} v_2(t) \\
    \vdots \\
   \mathcal{L} v_n(t) \\
  \end{array}
  \right] = \left[
  \begin{array}{c}
   V_1(s) \\
   V_2(s) \\
    \vdots \\
   V_n(s) \\
  \end{array}
  \right] = \mathbf{V}(s)$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For example, if<sup>1</sup></p>
$$\mathbf{v}(t)=\left[ \begin{array}{c}
   \epsilon(t) \\
   e^{-at} \\
   \sin bt \\
  \end{array} \right]$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>then $$\mathbf{V}(s)=\left[ \begin{array}{c}
   1/s \\
   1/(s+a) \\
   b/(s^2+b^2) \\
  \end{array} \right]$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Transform-of-State-Equations">Transform of State Equations<a class="anchor-link" href="#Transform-of-State-Equations"> </a></h3><p>Let us now transform the generalized form of the state equations obtained in the last lecture.</p>
$$\begin{eqnarray*}
  \frac{d\mathbf{x}(t)}{dt} &amp;=&amp;
  \mathbf{A}\mathbf{x}(t)+\mathbf{B}\mathbf{u}(t)\\
  \mathbf{y}(t)&amp;=&amp;\mathbf{C}\mathbf{x}(t)+\mathbf{D}\mathbf{u}(t)\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Applying the Laplace transform to both sides of this matrix equation
gives the transform equations</p>
$$\begin{eqnarray*}
  s\mathbf{X}(s)-\mathbf{x}(0) &amp;=&amp; 
  \mathbf{A}\mathbf{X}(s)+\mathbf{B}\mathbf{U}(s)\\
  \mathbf{Y}(s)&amp;=&amp;\mathbf{C}\mathbf{X}(s)+\mathbf{D}\mathbf{U}(s)\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>where $\mathbf{x}(0)$ is the vector of initial conditions vector of the
states; $\mathbf{X}(s)$ is the state transform vector; $\mathbf{U}(s)$
input transform vector; $\mathbf{Y}(s)$ is output transform vector.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Transformed-State-Equations-for-Example-1-from-Section">Transformed State-Equations for Example 1 from Section<a class="anchor-link" href="#Transformed-State-Equations-for-Example-1-from-Section"> </a></h3><p>For the system in the example the state vector is defined as $\mathbf{x}=[v_{31}, i_1]^{T}$, the input current is $u$, and the output variables are all the currents and voltages in the circuit $\mathbf{y}=[v_{31}, i_1, v_{32}, v_{21}, i_2]^{T}$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The transformed state space model is therefore:</p>
$$\begin{eqnarray}
 s\left[\begin{array}{c}
  V_{31} \\
  I_1
\end{array}\right]-\left[\begin{array}{c}
  v_{31}(0) \\
  i_1(0)
\end{array}\right]&amp;=&amp;\left[\begin{array}{cc}
  0 &amp; -1/C \\
  1/L &amp; -R/L
\end{array}\right]\left[\begin{array}{c}
  V_{31} \\
  I_1
\end{array}\right]+\left[\begin{array}{c}
  1/C \\
  0
\end{array}\right]\left[U\right]\\
\left[\begin{array}{c}
  V_{31} \\
  I_1 \\
  V_{32} \\
  V_{21} \\
  I_{2}
\end{array}\right]&amp;=&amp;\left[\begin{array}{cc}
  1 &amp; 0 \\
  0 &amp; 1 \\
  1 &amp; -R \\
  0 &amp; R \\
  0 &amp; -1
\end{array}\right]\left[\begin{array}{c}
  V_{31} \\
  I_1
\end{array}\right]+\left[\begin{array}{c}
  0 \\
  0 \\
  0 \\
  0 \\
  1
\end{array}\right]\left[U\right].\end{eqnarray}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Transfer-function-from-State-Space-Models">Transfer function from State-Space Models<a class="anchor-link" href="#Transfer-function-from-State-Space-Models"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The transform equations may be solved as follows (the Laplace transform operator $s$ is omitted for brevity).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Substituting $\mathbf{X}$ from (1) into (2) gives</p>
$$\begin{equation}
  \mathbf{Y}=\left[\mathbf{C}\left[s\mathbf{I}-\mathbf{A}\right]^{-1}\mathbf{B}\mathbf{U}+
  \mathbf{C}\left[s\mathbf{I}-\mathbf{A}\right]^{-1}\mathbf{x}(0)\right]+\mathbf{D}\mathbf{U}\end{equation}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>which after gathering terms and simplifying gives
$$\begin{equation}
  \mathbf{Y}=\left[\mathbf{C}\left[s\mathbf{I}-\mathbf{A}\right]^{-1}\mathbf{B}+\mathbf{D}\right]\mathbf{U}
      +\mathbf{C}
  \left[s\mathbf{I}-\mathbf{A}\right]^{-1}\mathbf{x}(0)\end{equation}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When the initial conditions of the state-variables are all zero, this
reduces to the transfer matrix model</p>
$$\begin{equation}
  \mathbf{Y}=\left[\mathbf{C}\left[s\mathbf{I}-\mathbf{A}\right]^{-1}\mathbf{B}+\mathbf{D}\right]\mathbf{U}\end{equation}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The matrix $\mathbf{C}\left[s\mathbf{I}-\mathbf{A}\right]^{-1}\mathbf{B}+\mathbf{D}$ is the <em>system transfer matrix</em>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The element of the $i$-th row and $j$-th column is the transfer function that relates the $i$-th output transform $Y_i$ to the $j$-th input transform $U_j$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For a single-input, single-output (SISO) system, the system transfer matrix reduces to a single element transfer function.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The matrix $\left[s\mathbf{I}-\mathbf{A}\right]^{-1}$ is very important.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is known as the <em>resolvent matrix</em> of the system.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It may be written as</p>
$$\left[s\mathbf{I}-\mathbf{A}\right]^{-1} =
        \frac{\mathrm{adj}\left[s\mathbf{I}-\mathbf{A}\right]}
             {\det\left[s\mathbf{I}-\mathbf{A}\right]}.$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Resolvent-matrix-for-the-example">Resolvent matrix for the example<a class="anchor-link" href="#Resolvent-matrix-for-the-example"> </a></h3><p>For the system in the example, the resolvent matrix is developed as</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\begin{equation*}
\mathbf{A}=\left[\begin{array}{cc}
  0 &amp; -1/C \\
  1/L &amp; -R/L
\end{array}\right] \end{equation*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\begin{equation*}
s\mathbf{I}-\mathbf{A}=\left[
\begin{array}{cc}
  s &amp; 0 \\
  0 &amp; s
\end{array}
\right] - \left[
\begin{array}{cc}
  0 &amp; -1/C \\
  1/L &amp; -R/L
\end{array}
\right] = \left[
\begin{array}{cc}
  s &amp; +1/C \\
  -1/L &amp; s+R/L
\end{array}\right] \end{equation*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\begin{equation*}
\left[s\mathbf{I}-\mathbf{A}\right]^{-1}=\frac{
\left[\begin{array}{cc}
  s+R/L &amp; -1/C \\
  +1/L &amp; s
\end{array} \right]
}{s(s+R/L)+1/(LC)}=\frac{\left[\begin{array}{cc}
  s+R/L &amp; -1/C \\
  +1/L &amp; s
\end{array} \right]}{s^2 + (R/L)s + 1/(LC) }\end{equation*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When $\left[s\mathbf{I}-\mathbf{A}\right]^{-1}$ has been obtained, then the system transfer function is easily obtained through $\mathbf{C}\left[s\mathbf{I}-\mathbf{A}\right]^{-1}\mathbf{B}+\mathbf{D}$.
For the system in the example, when all outputs are measured, the system transfer matrix is:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Transfer-matrix-for-example">Transfer matrix for example<a class="anchor-link" href="#Transfer-matrix-for-example"> </a></h3>$$\begin{equation*}
\left[\begin{array}{cc}
  1 &amp; 0 \\
  0 &amp; 1 \\
  1 &amp; -R \\
  0 &amp; R \\
  0 &amp; -1
\end{array}\right]
\left\{\frac{\left[
\begin{array}{cc}
  s+R/L &amp; -1/C \\
 +1/L &amp; s
\end{array}\right]}{s^2 + (R/L)s +1/(LC)}\right\}
\left[\begin{array}{c}
  1/C \\
  0
\end{array}\right]
 + \left[\begin{array}{c}
  0 \\
  0 \\
  0 \\
  0 \\
  1
\end{array} \right]
\end{equation*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\begin{equation*}
= \left[\begin{array}{cc}
  1 &amp; 0 \\
  0 &amp; 1 \\
  1 &amp; -R \\
  0 &amp; R \\
  0 &amp; -1
\end{array}\right]
\left\{\frac{\left[
\begin{array}{c}
  (1/C)s+R/(LC)  \\
 +1/(LC)
\end{array}\right]}{s^2 + (R/L)s +1/(LC)}\right\}
 + \left[\begin{array}{c}
  0 \\
  0 \\
  0 \\
  0 \\
  1
\end{array} \right]\end{equation*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\begin{equation*}
 = \frac{1}{s^2 + (R/L)s
+1/(LC)}\left[\begin{array}{c}
  (1/C)s+R/(LC) \\
  1/(LC) \\
  (1/C)s \\
  R/(LC) \\
  -1/(LC)
\end{array}\right] + \left[\begin{array}{c}
  0 \\
  0 \\
  0 \\
  0 \\
  1
\end{array} \right]\end{equation*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\begin{equation*}
= \left[\begin{array}{c}
  \frac{(1/C)s+R/(LC)}{s^2 + (R/L)s
+1/(LC)} \\
  \frac{1/(LC)}{s^2 + (R/L)s
+1/(LC)} \\
  \frac{(1/C)s}{s^2 + (R/L)s
+1/(LC)} \\
  \frac{R/(LC)}{s^2 + (R/L)s
+1/(LC)} \\
  -\frac{1/(LC)}{s^2 + (R/L)s
+1/(LC)}+1
\end{array}\right]\end{equation*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In matrix form, when combined with the input and output transforms we have the situation illustrated below. Each transfer function relates the corresponding output transform to the input transform.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For example</p>
$$V_{31}= \frac{(1/C)s+R/(LC)}{s^2 + (R/L)s
+1/(LC)}\ U.$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Transform-Equations-for-Example">Transform Equations for Example<a class="anchor-link" href="#Transform-Equations-for-Example"> </a></h3>$$\begin{eqnarray*}
\mathbf{Y}(s)&amp;=&amp;\left[\mathbf{C}\left[s\mathbf{I}-\mathbf{A}\right]^{-1}\mathbf{B}+\mathbf{D}\right]\mathbf{U}(s)\\
\mathbf{Y}(s) &amp;=&amp; \mathbf{G}(s)\mathbf{U}(s)\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\begin{eqnarray*}\left[\begin{array}{c}
  V_{31}(s) \\
  I_1(s) \\
  V_{32}(s) \\
  V_{21}(s) \\
  I_{2}(s)
\end{array}\right] &amp;=&amp; \left[\begin{array}{c}
  \frac{(1/C)s+R/(LC)}{s^2 + (R/L)s
+1/(LC)} \\
  \frac{1/(LC)}{s^2 + (R/L)s
+1/(LC)} \\
  \frac{(1/C)s}{s^2 + (R/L)s
+1/(LC)} \\
  \frac{R/(LC)}{s^2 + (R/L)s
+1/(LC)} \\
  -\frac{1/(LC)}{s^2 + (R/L)s
+1/(LC)}+1
\end{array}\right]\mathbf{U}(s).\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the denominator is the same for each transfer function, and
that the order of the numerator is less than the denominator except for
one case, for which</p>
$$\begin{eqnarray*}
I_2 &amp; = &amp; \left(-\frac{1/(LC)}{s^2 + (R/L)s +1/(LC)}+1\right)U\\
    &amp; = &amp; \frac{-1/{LC}+s^2 + (R/L)s +1/(LC)}{s^2 + (R/L)s
    +1/(LC)}\ U
    \\
    &amp; = &amp;\frac{s^2 + (R/L)s}{s^2 + (R/L)s
    +1/(LC)}\ U\end{eqnarray*}$$<p></p>
<p>Replacing $s$ by $\frac{d}{dt}$ gives the
corresponding differential equations relating the dependant variable to
the input.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Converting-SS-to-TF-in-Matlab">Converting SS to TF in Matlab<a class="anchor-link" href="#Converting-SS-to-TF-in-Matlab"> </a></h3><p>We will do this in class</p>
<p>Continuing example from <a href="../1/intro2ss">Section 7.1</a>:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">clear </span><span class="s">all</span><span class="p"></span>
<span class="n">format </span><span class="s">compact</span><span class="p"></span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define some values for capacitance, inductance and resitance</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Cap</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">L</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">R</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Define-state-space-model-and-label-states-inputs-and-outputs">Define state space model and label states inputs and outputs<a class="anchor-link" href="#Define-state-space-model-and-label-states-inputs-and-outputs"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">A</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">Cap</span><span class="p">;</span> <span class="mi">1</span><span class="o">/</span><span class="n">L</span> <span class="o">-</span><span class="n">R</span><span class="o">/</span><span class="n">L</span><span class="p">];</span>
<span class="n">B</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">Cap</span><span class="p">;</span> <span class="mi">0</span><span class="p">];</span>
<span class="n">C</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">;</span><span class="n"> 0 </span><span class="s">1</span><span class="p">;</span><span class="n"> 1 </span><span class="s">-R</span><span class="p">;</span><span class="n"> 0 </span><span class="s">R</span><span class="p">;</span><span class="n"> 0 </span><span class="s">-1]</span><span class="p">;</span>
<span class="n">D</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">1</span><span class="p">];</span>
<span class="n">circ_ss</span> <span class="p">=</span> <span class="n">ss</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="c">...</span>
<span class="s">&#39;statename&#39;</span><span class="p">,{</span><span class="s">&#39;v31&#39;</span> <span class="s">&#39;i1&#39;</span><span class="p">},</span> <span class="c">...</span>
<span class="s">&#39;inputname&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="c">...</span>
<span class="s">&#39;outputname&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;v31&#39;</span> <span class="s">&#39;i1&#39;</span> <span class="s">&#39;v32&#39;</span> <span class="s">&#39;v21&#39;</span> <span class="s">&#39;i2&#39;</span><span class="p">});</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Show-model">Show model<a class="anchor-link" href="#Show-model"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">circ_ss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
circ_ss =
 
  A = 
        v31   i1
   v31    0   -1
   i1     1   -1
 
  B = 
        u
   v31  1
   i1   0
 
  C = 
        v31   i1
   v31    1    0
   i1     0    1
   v32    1   -1
   v21    0    1
   i2     0   -1
 
  D = 
        u
   v31  0
   i1   0
   v32  0
   v21  0
   i2   1
 
Continuous-time state-space model.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Plot-a-step-response">Plot a step response<a class="anchor-link" href="#Plot-a-step-response"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">step</span><span class="p">(</span><span class="n">circ_ss</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/07/2/tf4ss_47_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Convert-to-transfer-functiom-matrix">Convert to transfer functiom matrix<a class="anchor-link" href="#Convert-to-transfer-functiom-matrix"> </a></h4><p>The function <code>tf(ss_model)</code> returns a vector of transfer functions.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">circ_tf</span> <span class="p">=</span> <span class="n">tf</span><span class="p">(</span><span class="n">circ_ss</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
circ_tf =
 
  From input &#34;u&#34; to output...
            s + 1
   v31:  -----------
         s^2 + s + 1
 
             1
   i1:  -----------
        s^2 + s + 1
 
              s
   v32:  -----------
         s^2 + s + 1
 
              1
   v21:  -----------
         s^2 + s + 1
 
          s^2 + s
   i2:  -----------
        s^2 + s + 1
 
Continuous-time transfer function.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Determine-poles-and-zeros">Determine poles and zeros<a class="anchor-link" href="#Determine-poles-and-zeros"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">circ_zpk</span><span class="p">=</span><span class="n">zpk</span><span class="p">(</span><span class="n">circ_ss</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
circ_zpk =
 
  From input &#34;u&#34; to output...
             (s+1)
   v31:  -------------
         (s^2 + s + 1)
 
              1
   i1:  -------------
        (s^2 + s + 1)
 
               s
   v32:  -------------
         (s^2 + s + 1)
 
               1
   v21:  -------------
         (s^2 + s + 1)
 
           s (s+1)
   i2:  -------------
        (s^2 + s + 1)
 
Continuous-time zero/pole/gain model.

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="The-state-transition-matrix">The state transition matrix<a class="anchor-link" href="#The-state-transition-matrix"> </a></h4><p>Calculated using the symbolic math tools provided by MATLAB See <code>help symbolic</code></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">syms </span><span class="s">phi t s</span><span class="p"></span>
<span class="n">phi</span> <span class="p">=</span> <span class="n">inv</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="nb">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>phi =
[ (s + 1)/(s^2 + s + 1), -1/(s^2 + s + 1)]
[       1/(s^2 + s + 1),  s/(s^2 + s + 1)]
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="The-state-transfer-matrix">The state transfer matrix<a class="anchor-link" href="#The-state-transfer-matrix"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">G</span> <span class="p">=</span> <span class="n">C</span><span class="o">*</span><span class="n">phi</span><span class="o">*</span><span class="n">B</span> <span class="o">+</span> <span class="n">D</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>G =
                   (s + 1)/(s^2 + s + 1)
                         1/(s^2 + s + 1)
 (s + 1)/(s^2 + s + 1) - 1/(s^2 + s + 1)
                         1/(s^2 + s + 1)
                     1 - 1/(s^2 + s + 1)
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">G</span> <span class="p">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>G =
 (s + 1)/(s^2 + s + 1)
       1/(s^2 + s + 1)
       s/(s^2 + s + 1)
       1/(s^2 + s + 1)
   1 - 1/(s^2 + s + 1)
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">pretty</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/      s + 1     \
|   ----------   |
|    2           |
|   s  + s + 1   |
|                |
|        1       |
|   ----------   |
|    2           |
|   s  + s + 1   |
|                |
|        s       |
|   ----------   |
|    2           |
|   s  + s + 1   |
|                |
|        1       |
|   ----------   |
|    2           |
|   s  + s + 1   |
|                |
|          1     |
| 1 - ---------- |
|      2         |
\     s  + s + 1 /

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A executable script version of this example is available as <a href="matlab/ssmodels.mlx">ssmodels.mlx</a>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Some-Important-Properties">Some Important Properties<a class="anchor-link" href="#Some-Important-Properties"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="System-poles">System poles<a class="anchor-link" href="#System-poles"> </a></h3><p>Clearly the denominator of the transfer function is generated by the
matrix inverse which produces the term:</p>
$$\det[s\mathbf{I}-\mathbf{A}]$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This evaluates to the denominator polynomial and the poles of the system
are the roots of the system's characteristic equation:</p>
$$\det[s\mathbf{I}-\mathbf{A}] = 0.$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The system poles are solutions to the system's characteristic equation</p>
$$\det[s\mathbf{I}-\mathbf{A}] = 0.$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="System-zeros">System zeros<a class="anchor-link" href="#System-zeros"> </a></h3><p>What is the corresponding numerator polynomial of the transfer function,
whose roots give the zeros of the system?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The zeros are those values of
$s$ for which the output is zero when the input and states are not zero.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thus: $$\begin{eqnarray*}
(s\mathbf{I}-\mathbf{A})\mathbf{X}-\mathbf{B}U &amp; = &amp; \mathbf{0} \\
\mathbf{CX}+dU = Y &amp; = &amp; 0\end{eqnarray*}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In matrix form:</p>
$$\left[ {\begin{array}{*{20}c}
   {s{\bf{I}} - {\bf{A}}} &amp;  \vdots  &amp; {\bf{B}}  \\
    \cdots  &amp;  \cdots  &amp;  \cdots   \\
   {\bf{C}} &amp;  \vdots  &amp; d  \\
\end{array}} \right]\left[ {\begin{array}{*{20}c}
   {\bf{X}}  \\
    \cdots   \\
   U  \\
\end{array}} \right] = \left[ {\begin{array}{*{20}c}
   {\bf{0}}  \\
    \cdots   \\
   0  \\
\end{array}} \right]$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The only way this can have non-zero solutions in $\mathbf{X}$ and $U$ is
if:</p>
$$\det \left[ {\begin{array}{*{20}c}
   {s{\bf{I}} - {\bf{A}}} &amp;  \vdots  &amp; {\bf{B}}  \\
    \cdots  &amp;  \cdots  &amp;  \cdots   \\
   {\bf{C}} &amp;  \vdots  &amp; d  \\
\end{array}} \right] = 0$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is another polynomial in $s$ whose roots
give the system zeros and therefore corresponds to the numerator
polynomial of the TF.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Given this result, an alternative expression for the TF is:</p>
$$\frac{Y(s)}{U(s)} = \frac{\det \left[ \begin{array}{*{20}c}
   s\bf{I} - \bf{A} &amp;  \vdots  &amp; \bf{B}  \\
    \cdots  &amp;  \cdots  &amp;  \cdots   \\
   \bf{C} &amp;  \vdots  &amp; d  \\
\end{array} \right]}{\det [s\bf{I} - \bf{A}]}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Time-Responses-from-Transfer-Function-Matrices">Time Responses from Transfer Function Matrices<a class="anchor-link" href="#Time-Responses-from-Transfer-Function-Matrices"> </a></h2><p>In the <a href="../3/tr4ss">next section</a> we will consider how we can use the transfer function model to compute time responses from state-space models.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Footnote">Footnote<a class="anchor-link" href="#Footnote"> </a></h2><ol>
<li>$\epsilon(t)$ is the unit step function $\epsilon(t)=0$ for
 $t &lt; 0$; $\epsilon(t)=1$ for $t \ge 0$.</li>
</ol>

</div>
</div>
</div>
</div>

 


    </main>
    