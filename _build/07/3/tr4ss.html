---
interact_link: content/07/3/tr4ss.ipynb
kernel_name: matlab
kernel_path: content/07/3
has_widgets: false
title: |-
  Time Response for State Space Models
pagenum: 31
prev_page:
  url: /07/2/tf4ss.html
next_page:
  url: /07/4/canon.html
suffix: .ipynb
search: s mathbf frac t array right end begin left x e phi response state system eqnarray c matrix cc y zero n equation input u mathrm b p initial space transform label eq vector characteristic cdots model laplace resolvent modes epsilon d conditions leq lefts transition section given inverse function element values pn linear ss mathcal l condition nonumber adj polynomial called r where combination example zi zs full transformed domain define form functions known vdots transforming leqa output step matlab compute models shall determine last tfss development dot show consider becomes polynomials variables through set order therefore sn eigen

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Time Response for State Space Models</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Time-Response-for-State-Space-Models">Time Response for State Space Models<a class="anchor-link" href="#Time-Response-for-State-Space-Models"> </a></h1><p>In this section we shall determine the time response of a system
represented by a state-space model. We shall take as a starting point
the transformed state space model developed in the <a href="../2/tf4ss">last section</a>.</p>
<p>It is
possible to derive the time response directly in the time domain from
the state-equations. I believe however, that the following development
will be easier to understand. I advise you to consult any text book for
the time domain development.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the <a href="../2/tf4ss">last section</a>, we showed that the state space model was</p>
$$\begin{eqnarray*}
     \dot{\mathbf{x}}(t) &amp; = &amp;
            \mathbf{A}\mathbf{x}(t)+\mathbf{B}\mathbf{u}(t) \\\\
          \mathbf{y}(t) &amp; = &amp;
             \mathbf{C}\mathbf{x}(t)+\mathbf{D}\mathbf{u}(t)
   \end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>and that
the transformed equation was</p>
$$\begin{eqnarray*}
    s\mathbf{X}(s) - \mathbf{x}(0) &amp; = &amp;
                 \mathbf{A}\mathbf{X}(s)+\mathbf{B}\mathbf{U}(s) \\\\
     \mathbf{Y}(s)                 &amp; = &amp;
                 \mathbf{C}\mathbf{X}(s)+\mathbf{D}\mathbf{U}(s)
  \end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this section we will show how the time
response of the state space model may be derived from the transformed
model.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Zero-Input-Response">Zero Input Response<a class="anchor-link" href="#Zero-Input-Response"> </a></h2><p>We first consider the response of the system to its initial conditions
and zero input. This is the <em>zero input response</em> or homogeneous
response of the system.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the input transform $U(s)=0$ the state
equation becomes</p>
$$\mathbf{X}(s)=\left[s\mathbf{I}-\mathbf{A}\right]^{-1}\mathbf{x}(0).$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We define
$$\Phi(s) = \left[s\mathbf{I}-\mathbf{A}\right]^{-1}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>so that</p>
$$\begin{equation}\label{eq:l4eq1}
\mathbf{X}(s)=\Phi(s)\mathbf{x}(0)\end{equation}$$<p></p>
<p>is the transform of the zero input
state response.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the time domain, the corresponding state response is
given by the inverse Laplace transform of
equationÂ (1)</p>
$$\begin{equation}\label{eq:l4eq2} \mathbf{x}(t) = \mathcal{L}^{-1}
\left\{\Phi(s)\mathbf{x}(0)\right\},\end{equation}$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>which, since the initial
condition vector $\mathbf{x}(0)$ is a vector of constants becomes:</p>
$$\begin{eqnarray}
\mathbf{x}(t) &amp; = &amp; \mathcal{L}^{-1}
\left\{\Phi(s)\right\}\mathbf{x}(0)\nonumber \\ &amp; = &amp;
\phi(t)\mathbf{x}(0).\label{eq:l4eq3}\end{eqnarray}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Resolvent-matrix">Resolvent matrix<a class="anchor-link" href="#Resolvent-matrix"> </a></h3><p>The <em>resolvent matrix</em> is defined as</p>
$$\Phi(s) = \left[s\mathbf{I}-\mathbf{A}\right]^{-1} =
\frac{\mathrm{adj}\left[s\mathbf{I}-\mathbf{A}{}\right]}{\left|s\mathbf{I}-\mathbf{A}\right|}.$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The resolvent matrix is a matrix of rational polynomials in the Laplace transform variable $s$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The state transition matrix is</p>
$$\phi(t) = \mathcal{L}^{-1}\left\{\frac{\mathrm{adj}\left[s\mathbf{I}-\mathbf{A}{}\right]}{\left|s\mathbf{I}-\mathbf{A}\right|}\right\}.$$<p></p>
<p>What is the form of this function?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="State-Transition-Matrix">State Transition Matrix<a class="anchor-link" href="#State-Transition-Matrix"> </a></h2><p>The vector of time functions $\phi(t)$ is known as the <em>state transition
matrix</em>. It defines the motion (or <em>trajectory</em>) of the state variables
through the $n$-dimensional <em>state space</em> from a given set of initial
states.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Characteristic-Polynomial">Characteristic Polynomial<a class="anchor-link" href="#Characteristic-Polynomial"> </a></h3><p>The adjoint
matrix $\mathrm{adj}\left[s\mathbf{I}-\mathbf{A}{}\right]$ is a matrix of polynomials each of which is of
order $n-1$ or less.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The determinant
$$\left|s\mathbf{I}-\mathbf{A}\right| = \left|\begin{array}{cccc}
  s-a_{11} &amp; -a_{12} &amp; \cdots &amp; -a_{1n} \\
  -a_{21} &amp; s-a_{22} &amp; \cdots &amp; -a_{2n} \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  -a_{n1} &amp; -a_{2n} &amp; \cdots &amp; s-a_{nn}
\end{array}\right|$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>is called the <em>characteristic polynomial</em>. It is
always a polynomial of degree $n$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Therefore each element of the
resolvent matrix $\Phi(s)$ is of the form</p>
$$\frac{b_{n-1}s^{n-1}+ \cdots + b_0}{s^n + a_{n-1}s^{n-1}+\cdots+a_0}.$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="System-Characteristic-(or-Eigen)-Values">System Characteristic (or Eigen) Values<a class="anchor-link" href="#System-Characteristic-(or-Eigen)-Values"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The
coefficients $b_i$ of each element of the resolvent matrix $\Phi(s)$
depend on the form of the system. The characteristic polynomial
$\left|s\mathbf{I}-\mathbf{A}\right|$ is the common denominator of all elements of $\Phi(s)$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$\Phi(s)$ may be factorized:</p>
$$\begin{eqnarray*}
\left|s\mathbf{I}-\mathbf{A}\right|&amp;=&amp;s^n + a_{n-1}s^{n-1} + \cdots + a_1s + a_0
\\
&amp;=&amp;(s - p_1)(s-p_2)\cdots(s-p_n)\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The values $p_i$ are
known as the <em>characteristic</em> (or <em>eigen</em>) values of the state matrix
$\mathbf{A}$. The characteristic values are the <em>poles</em> of the system!</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Zero-input-response">Zero-input response<a class="anchor-link" href="#Zero-input-response"> </a></h2><p>If we make
a partial fraction expansion of the characteristic equation, then for
the $i$-$j$th element of the resolvent matrix we have</p>
$$\Phi_{ij}(s)=\frac{r_1}{s-p_1}+\frac{r_2}{s-p_2} + \cdots +
\frac{r_n}{s-p_n}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(where the coefficient $r_i$ is the so called
<em>residue</em> of the partial fraction expansion determined at the value
$s=p_i$).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Inverse Laplace transforming this equation we finally obtain
the <em>state transition</em> function:</p>
$$\phi_{ij}(t) = r_1 e^{p_1 t} + r_2 e^{p_2 t} + \cdots + r_n
e^{p_n t}.$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="System-'modes'">System 'modes'<a class="anchor-link" href="#System-'modes'"> </a></h3><p>The state
transition matrix $\phi(t)$ is an $n\times n$ matrix, each element of
which is a linear combination of the $n$ "mode functions" (or simply
<em>modes</em>)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$e^{p_1 t},\ e^{p_2 t},\ \ldots,\ e^{p_n t}.$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Each mode is
constructed from the eigenvalues ($p_1,\ p_2,\ \ldots,\ p_n$) of the
state matrix $\mathbf{A}$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The eigenvalues are also known as the
<em>poles</em> of the system.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example">Example<a class="anchor-link" href="#Example"> </a></h3><p>If</p>
$$\mathbf{A} = \left[\begin{array}{cc}
  0 &amp; 1 \\
  -6 &amp; -5
\end{array}\right]$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$s\mathbf{I}-\mathbf{A} = \left[\begin{array}{cc}
  s &amp; -1 \\
  6 &amp; s+5
\end{array}\right]$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>so</p>
$$\left|s\mathbf{I}-\mathbf{A}\right| = s^2 + 5s + 6 = (s+2)(s+3).$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The characteristic values of the system are $p_1=-2$ and $p_2=-3$ so the
modes are $e^{-2t}$ and $e^{-3t}$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now</p>
$$\mathrm{adj}\left[s\mathbf{I}-\mathbf{A}{}\right] = \left[\begin{array}{cc}
  s+5 &amp; 1 \\
  -6 &amp; s
\end{array}\right]$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>so the resolvent matrix is</p>
$$\Phi(s) = \left[\begin{array}{cc}
  \frac{s+5}{(s+2)(s+3)} &amp; \frac{1}{(s+2)(s+3)} \\
  \frac{-6}{(s+2)(s+3)} &amp; \frac{s}{(s+2)(s+3)}
\end{array}\right].$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Expanding each element of $\Phi(s)$ we get</p>
$$\Phi(s) = \left[\begin{array}{cc}
  \frac{3}{s+2}-\frac{2}{s+3} &amp; \frac{1}{s+2}-\frac{1}{s+3} \\
  \frac{-6}{s+2}+\frac{6}{s+3} &amp; -\frac{2}{s+2}+\frac{3}{s+3}
\end{array}\right].$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Inverse Laplace transforming this we get the final
state transition matrix, representing the zero-input response of the
system:</p>
$$\phi(t)=\left[\begin{array}{cc}
  3e^{-2t}-2e^{-3t} &amp; e^{-2t}-e^{-3t} \\
 -6e^{-2t}+6e^{-3t} &amp; -2e^{-2t}+3e^{-3t}
\end{array}\right].$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that, by an alternative derivation<sup>1</sup>, we can show that</p>
$$\phi(t)=e^{\mathbf{A}t}$$<p>where $e^{\mathbf{A}t}$ is called the matrix
exponential.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Zero-Input-System-Response">Zero Input System Response<a class="anchor-link" href="#Zero-Input-System-Response"> </a></h3><p>For non-zero
initial conditions and zero input we have</p>
$$\begin{eqnarray}
\label{eq:l4eq6a}
  \mathbf{X}(s)&amp;=&amp;\left[s\mathbf{I}-\mathbf{A}\right]^{-1}\mathbf{x}(0) \nonumber\\
&amp;=&amp; \Phi(s)\mathbf{x}(0) \label{eq:l4eq7a}\end{eqnarray}$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The zero-input
system output transform is therefore given by</p>
$$\begin{equation}\label{eq:l4eq8a}
 \mathbf{Y}_\mathrm{zi}(s)=\mathbf{C}\Phi(s)\mathbf{x}(0).\end{equation}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because we have already shown that $\phi(t)$ will be a linear
combination of modes, the unforced system response $y(t)$ will be
another linear combination of the same modes.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We now consider the case where the initial condition vector
$\mathbf{x}(0)=\mathbf{0}$ and we will obtain the response of the system
to an input. This is called the <em>zero state response</em> of the system.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Zero-State-Response">The Zero State Response<a class="anchor-link" href="#The-Zero-State-Response"> </a></h2><p>For zero initial
conditions we have</p>
$$\begin{eqnarray}
\label{eq:l4eq6}
  \mathbf{X}(s)&amp;=&amp;\left[s\mathbf{I}-\mathbf{A}\right]^{-1}\mathbf{B}\mathbf{U}(s) \nonumber \\
&amp;=&amp; \Phi(s)\mathbf{B}\mathbf{U}(s) \label{eq:l4eq7}\end{eqnarray}$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The
system output transform (forced response) is given by</p>
$$\begin{equation}\label{eq:l4eq8}
 \mathbf{Y}_{\mathrm{zs}}(s)=\left[\mathbf{C}\Phi(s)\mathbf{B}+\mathbf{D}\right]\mathbf{U}(s)\end{equation}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(where $\mathbf{C}\Phi(s)\mathbf{B}+\mathbf{D}$ is the system transfer matrix).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Full-System-Response">Full System Response<a class="anchor-link" href="#Full-System-Response"> </a></h2><p>The full system response for the state-space model is simply the sum of
the zero-state and zero-input responses:</p>
$$\begin{eqnarray}
\mathbf{Y}_{\mathrm{full}}(s) &amp;=&amp; \mathbf{Y}_{\mathrm{zs}}(s) +
\mathbf{Y}_{\mathrm{zi}}(s)\nonumber\\ &amp;=&amp;
\mathbf{C}\Phi(s)\left[\mathbf{x}(0)+\mathbf{B}\mathbf{U}(s)\right] + \mathbf{DU}(s).\end{eqnarray}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="End-of-Pre-Class-Presentation">End of Pre-Class Presentation<a class="anchor-link" href="#End-of-Pre-Class-Presentation"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the class we will reinforce these concepts by working through an
example in detail.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example">Example<a class="anchor-link" href="#Example"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let</p>
$$\begin{eqnarray*}
\dot{\mathbf{x}}&amp;=&amp;\left[\begin{array}{cc}
  0 &amp; 1 \\
  -6 &amp; -5
\end{array}\right]\mathbf{x}+\left[\begin{array}{cc}
  2 &amp; 1 \\
 -1 &amp; 0
\end{array}\right]\mathbf{u}\\
\mathbf{y}&amp;=&amp;\left[\begin{array}{cc}
  2 &amp; -1 \\
  0 &amp; 1
\end{array}\right]\mathbf{x}\\ \mathbf{u}&amp;=&amp;\left[\begin{array}{c}
  e^{-t} \\
  \epsilon(t)
\end{array}\right].\end{eqnarray*}$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Calculate the full system response
for this system given that the initial conditions are
$\mathbf{x}(0)=[-1, 1]^T$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Solution-to-Example">Solution to Example<a class="anchor-link" href="#Solution-to-Example"> </a></h3><p>The transfer function is</p>
$$\begin{eqnarray*}
\mathbf{G}(s)&amp;=&amp;\mathbf{C}\Phi(s)\mathbf{B} =
\left[\begin{array}{cc}
  2 &amp; -1 \\
  0 &amp; 1
\end{array}\right]
\left[\begin{array}{cc}
  \frac{s+5}{(s+2)(s+3)} &amp; \frac{1}{(s+2)(s+3)} \\
  \frac{-6}{(s+2)(s+3)} &amp; \frac{s}{(s+2)(s+3)}
\end{array}\right]\left[\begin{array}{cc}
  2 &amp; 1 \\
 -1 &amp; 0
\end{array}\right]\\
&amp;=&amp;\left[\begin{array}{cc}
  2 &amp; -1 \\
  0 &amp; 1
\end{array}\right]
\left[\begin{array}{cc}
  \frac{2s+9}{(s+2)(s+3)} &amp; \frac{s+5}{(s+2)(s+3)} \\
  \frac{-s-12}{(s+2)(s+3)} &amp; \frac{-6}{(s+2)(s+3)}
\end{array}\right]\\
&amp;=&amp; \left[\begin{array}{cc}
  \frac{5s+30}{(s+2)(s+3)} &amp; \frac{2s+16}{(s+2)(s+3)} \\
   \frac{-s-12}{(s+2)(s+3)} &amp; \frac{-6}{(s+2)(s+3)}
\end{array}\right]\end{eqnarray*}$$<p>The transform of the input vector is</p>
$$\mathbf{U}(s) = \mathcal{L}\left[\begin{array}{c}
  e^{-t} \\
  \epsilon(t)
\end{array}\right] = \left[\begin{array}{c}
  \frac{1}{s+1} \\
  \frac{1}{s}
\end{array}\right].$$<p>Hence $$\begin{eqnarray*}
\mathbf{Y}(s) &amp;=&amp; \left[\begin{array}{cc}
  \frac{5s+30}{(s+2)(s+3)} &amp; \frac{2s+16}{(s+2)(s+3)} \\
   \frac{-s-12}{(s+2)(s+3)} &amp; \frac{-6}{(s+2)(s+3)}
\end{array}\right]\left[\begin{array}{c}
  \frac{1}{s+1} \\
  \frac{1}{s}
\end{array}\right]\\
&amp;=&amp;\left[\begin{array}{c}
  \frac{7s^2+48s+16}{s(s+1)(s+2)(s+3)} \\
  \frac{-(s^2+18s+6)}{s(s+1)(s+2)(s+3)}
\end{array}\right] = \left[\begin{array}{c}
  \frac{8/3}{s}+\frac{25/2}{s+1}-\frac{26}{s+2}+\frac{65/6}{s+3} \\
   -\frac{1}{s}-\frac{11/2}{s+1}+\frac{13}{s+2}-\frac{13/2}{s+3}
\end{array}\right]\end{eqnarray*}$$</p>
<p>Inverse Laplace transforming the previous result gives the zero-state
output response of the system:</p>
$$\left[\begin{array}{c}
  \frac{8}{3}\epsilon(t)+\frac{25}{2}e^{-t}-26e^{-2t}+\frac{65}{6}e^{-3t} \\
   -\epsilon(t)-\frac{11}{2}e^{-t}+13e^{-2t}-\frac{13}{2}e^{-3t}
\end{array}\right].$$<p></p>
<p>Note that response is now a linear combination of
the system modes ($e^{-2t}$ and $e^{-3t}$) and the input modes
($\epsilon(t)$ [the unit step function] and $e^{-t}$).</p>
<p>If the initial condition vector $\mathbf{x}(0)=[-1, 1]^T$ what is the
total response of the system?</p>
$$\begin{eqnarray*}
 \mathbf{Y}(s)&amp;=&amp;
\left[\begin{array}{cc}
  2 &amp; -1 \\
  0 &amp; 1
\end{array}\right]
\left[\begin{array}{cc}
  \frac{s+5}{(s+2)(s+3)} &amp; \frac{1}{(s+2)(s+3)} \\
  \frac{-6}{(s+2)(s+3)} &amp; \frac{s}{(s+2)(s+3)}
\end{array}\right]\\
&amp;\times&amp; \left\{\left[\begin{array}{c}
  -1 \\
  1
\end{array}\right]+\left[\begin{array}{cc}
  2 &amp; 1 \\
  -1 &amp; 0
\end{array}\right]\left[\begin{array}{c}
  \frac{1}{s+1} \\
  \frac{1}{s}
\end{array}\right]\right\}\\
&amp;=&amp; \left[\begin{array}{cc}
  \frac{2s+16}{(s+2)(s+3)} &amp; \frac{-s+2}{(s+2)(s+3)} \\
  \frac{-6}{(s+2)(s+3)} &amp; \frac{s}{(s+2)(s+3)}
\end{array}\right]\left[\begin{array}{c}
  \frac{-s^2+2s+1}{s(s+1)} \\
  \frac{s^2}{s(s+1)}
\end{array}\right]\end{eqnarray*}$$$$\begin{eqnarray*}
\mathbf{Y}(s)&amp;=&amp; \left[\begin{array}{c}
  \frac{-3s^2-10s^2+34s+16}{s(s+1)(s+2)(s+3)} \\
  \frac{s^3+6s^2-12s-6}{s(s+1)(s+2)(s+3)}
\end{array}\right]\\
\mathbf{y}(t)&amp;=&amp; \left[\begin{array}{c}
  \frac{8}{3}\epsilon(t)+\frac{25}{2}e^{-t}-34e^{-2t}+\frac{59}{6}e^{-3t} \\
   -\epsilon(t)-\frac{11}{2}e^{-t}+17e^{-2t}-\frac{19}{2}e^{-3t}
\end{array}\right].\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Solving-this-problem-in-MATLAB">Solving this problem in MATLAB<a class="anchor-link" href="#Solving-this-problem-in-MATLAB"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can use the symbolic toolbox!</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Set up the problem ... we can use ordinary matrices for this</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">format </span><span class="s">compact</span><span class="p"></span>
<span class="n">A</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">;</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">];</span> <span class="n">B</span> <span class="p">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">;</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
<span class="n">C</span> <span class="p">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span> <span class="n">D</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
<span class="n">x0</span> <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now define $s$ and $t$ as symbolic variables</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">syms </span><span class="s">t s</span><span class="p"></span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define input vector $\mathbf{U}(s)$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">u</span> <span class="p">=</span> <span class="p">[</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">);</span><span class="n">heaviside</span><span class="p">(</span><span class="n">t</span><span class="p">)];</span>
<span class="n">Us</span> <span class="p">=</span> <span class="n">laplace</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Us =
 1/(s + 1)
       1/s
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Compute $\Phi(s)$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">PhiS</span> <span class="p">=</span> <span class="n">inv</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="nb">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>PhiS =
[ (s + 5)/(s^2 + 5*s + 6), 1/(s^2 + 5*s + 6)]
[      -6/(s^2 + 5*s + 6), s/(s^2 + 5*s + 6)]
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now compute zero state response:</p>
$$\mathbf{Y}_{\mathrm{zs}}(s) = \left(\mathbf{C}\mathbf{\Phi}(s)\mathbf{B}+\mathbf{D}\right)$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Yzs</span> <span class="p">=</span> <span class="p">(</span><span class="n">C</span><span class="o">*</span><span class="n">PhiS</span><span class="o">*</span><span class="n">B</span> <span class="o">+</span> <span class="n">D</span><span class="p">)</span><span class="o">*</span><span class="n">Us</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Yzs =
 (s/(s^2 + 5*s + 6) + 10/(s^2 + 5*s + 6) + (4*(s + 5))/(s^2 + 5*s + 6))/(s + 1) + (6/(s^2 + 5*s + 6) + (2*(s + 5))/(s^2 + 5*s + 6))/s
                                                           - 6/(s*(s^2 + 5*s + 6)) - (s/(s^2 + 5*s + 6) + 12/(s^2 + 5*s + 6))/(s + 1)
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unforced (zero-initial condition) response:</p>
$$\mathbf{Y}_{\mathrm{zi}}(s) = \left(\mathbf{C}\mathbf{\Phi}(s)\mathbf{B}+\mathbf{D}\right)$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Yzi</span> <span class="p">=</span> <span class="n">C</span><span class="o">*</span><span class="n">PhiS</span><span class="o">*</span><span class="n">x0</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Yzi =
 - s/(s^2 + 5*s + 6) - 4/(s^2 + 5*s + 6) - (2*(s + 5))/(s^2 + 5*s + 6)
                                 s/(s^2 + 5*s + 6) + 6/(s^2 + 5*s + 6)
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Total response:</p>
$$\mathbf{Y}(s) = \mathbf{Y}_{\mathrm{zs}}(s) + \mathbf{Y}_{\mathrm{zi}}(s)$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">Ytotal</span> <span class="p">=</span> <span class="n">Yzs</span> <span class="o">+</span> <span class="n">Yzi</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Ytotal =
 (s/(s^2 + 5*s + 6) + 10/(s^2 + 5*s + 6) + (4*(s + 5))/(s^2 + 5*s + 6))/(s + 1) - 4/(s^2 + 5*s + 6) - s/(s^2 + 5*s + 6) - (2*(s + 5))/(s^2 + 5*s + 6) + (6/(s^2 + 5*s + 6) + (2*(s + 5))/(s^2 + 5*s + 6))/s
                                                                                           s/(s^2 + 5*s + 6) + 6/(s^2 + 5*s + 6) - 6/(s*(s^2 + 5*s + 6)) - (s/(s^2 + 5*s + 6) + 12/(s^2 + 5*s + 6))/(s + 1)
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally compute the time response $\mathbf{y}(t)$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">y</span> <span class="p">=</span> <span class="n">ilaplace</span><span class="p">(</span><span class="n">Ytotal</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>y =
 (25*exp(-t))/2 - 34*exp(-2*t) + (95*exp(-3*t))/6 + 8/3
   17*exp(-2*t) - (11*exp(-t))/2 - (19*exp(-3*t))/2 - 1
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Plot response</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">ezplot</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">),[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">]),</span><span class="n">grid</span><span class="p">,</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;y_1(t)&#39;</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">ezplot</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">),[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">]),</span><span class="n">grid</span><span class="p">,</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;y_2(t)&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/07/3/tr4ss_71_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Simulation-of-State-Space-Models-in-Matlab">Simulation of State Space Models in Matlab<a class="anchor-link" href="#Simulation-of-State-Space-Models-in-Matlab"> </a></h3><ul>
<li><p>The functions <code>step</code> and <code>impulse</code> will produce step impulse
responses of a system with zero initial conditions.</p>
</li>
<li><p>The function <code>lsim</code> can be used to determine the state space
response to arbitrary inputs.</p>
</li>
<li><p>If you need to simulate a system with arbitrary inputs and
predefined initial conditions, you should use the <em>Linear Simulation
Tool</em> which is opened when you execute <code>lsim(model)</code>.</p>
</li>
</ul>
<p>Visit the MATLAB Control Systems Toolbox help pages to find out more.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Footnote">Footnote<a class="anchor-link" href="#Footnote"> </a></h2><ol>
<li><p>For a first order differential equation</p>
<p>$$\frac{dx}{dt}=ax$$</p>
<p>so
 the Laplace transform is</p>
<p>$$\begin{eqnarray*}
 sX(s) - x(0) &amp; = &amp;
 aX(s)\\ X(s)(s - a)&amp; = &amp; x(0)\\ X(s)
 &amp;=&amp;\frac{x(0)}{s-a}.\end{eqnarray*}$$</p>
<p>The inverse laplace transform of
 the final equation gives</p>
<p>$$x(t) = e^{at}.$$</p>
<p>For the vector case</p>
<p>$$s\mathbf{X}(s)-\mathbf{x}(0)=\mathbf{A}\mathbf{X(s)}$$</p>
<p>so by
 comparison</p>
<p>$$\mathbf{x}(t)=e^{\mathbf{A} t}.$$</p>
<p>The proper proof is
 of course a little more involved and will be explored in <a href="../5/gensolution">Section 7.6</a>!</p>
</li>
</ol>

</div>
</div>
</div>
</div>

 


    </main>
    